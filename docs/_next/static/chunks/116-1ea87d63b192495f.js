(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[116],{9116:function(e,t,n){"use strict";n.d(t,{By:function(){return w},CP:function(){return d},Dk:function(){return a},EJ:function(){return p},HE:function(){return l},Kn:function(){return s},ST:function(){return u},U1:function(){return c},a$:function(){return g},et:function(){return i},lk:function(){return f},pH:function(){return m},tG:function(){return h}}),n(257);let r="https://api.patreek.com";function o(e){return{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(e)}}async function a(){try{let e=new AbortController,t=setTimeout(()=>e.abort(),1e4),n=new URLSearchParams(window.location.search),o=null==n?void 0:n.get("bypass"),a="".concat(r,"/api/v1/feeds/public").concat("ag3nt007"===o?"?bypass=ag3nt007":""),i=await fetch(a,{method:"GET",cache:"default",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:e.signal});if(clearTimeout(t),!i.ok)return console.warn("[API] Failed to fetch public feeds: ".concat(i.status)),[];return((await i.json()).content||[]).slice(0,30)}catch(e){return e instanceof Error?"AbortError"===e.name||e.message.includes("timeout")||e.message.includes("TIMED_OUT")?console.warn("[API] Connection timeout while fetching public feeds - backend may be unavailable"):e.message.includes("Failed to fetch")||e.message.includes("ERR_CONNECTION")?console.warn("[API] Connection error while fetching public feeds - backend may be unavailable"):console.warn("[API] Error fetching public feeds:",e.message):console.warn("[API] Unknown error fetching public feeds:",e),[]}}async function i(e){try{let t=new AbortController,n=setTimeout(()=>t.abort(),1e4),a=await fetch("".concat(r,"/api/v1/user/profile"),{method:"GET",headers:o(e),signal:t.signal});if(clearTimeout(n),!a.ok)return console.warn("[API] Failed to fetch user profile:",a.status),null;return a.json()}catch(e){return console.warn("[API] Error fetching user profile",e),null}}async function c(e){try{let t=new AbortController,n=setTimeout(()=>t.abort(),1e4),a=await fetch("".concat(r,"/api/v1/categories"),{method:"GET",headers:o(e),signal:t.signal});if(clearTimeout(n),!a.ok)return console.warn("[API] Failed to fetch user categories:",a.status),[];let i=await a.json();if(Array.isArray(i))return i;if(Array.isArray(null==i?void 0:i.content))return i.content;if(Array.isArray(null==i?void 0:i.categories))return i.categories;return[]}catch(e){return console.warn("[API] Error fetching user categories",e),[]}}async function s(e){try{let t=new AbortController,n=setTimeout(()=>t.abort(),1e4),a=await fetch("".concat(r,"/api/v1/feeds"),{method:"GET",headers:o(e),signal:t.signal});if(clearTimeout(n),!a.ok)return console.warn("[API] Failed to fetch user feeds:",a.status),[];return(await a.json()).content||[]}catch(e){return console.warn("[API] Error fetching user feeds",e),[]}}async function l(e,t){try{let n=new AbortController,a=setTimeout(()=>n.abort(),1e4),i=await fetch("".concat(r,"/api/v1/feeds/category/").concat(t),{method:"GET",headers:o(e),signal:n.signal});if(clearTimeout(a),!i.ok)return console.warn("[API] Failed to fetch feeds for category:",i.status),[];return(await i.json()).content||[]}catch(e){return console.warn("[API] Error fetching category feeds",e),[]}}async function u(e){try{let t=new AbortController,n=setTimeout(()=>t.abort(),1e4),o=new URLSearchParams(window.location.search),a=null==o?void 0:o.get("bypass"),i="".concat(r,"/api/v1/feeds/").concat(e).concat("ag3nt007"===a?"?bypass=ag3nt007":"");console.log("[API] Fetching article ".concat(e," from: ").concat(i));let c=await fetch(i,{method:"GET",cache:"default",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"omit",mode:"cors",signal:t.signal});if(clearTimeout(n),!c.ok){let t=/^((?!chrome|android).)*safari/i.test(window.navigator.userAgent);if(404===c.status||403===c.status)return t&&console.error("[API] Safari: Article ".concat(e," returned ").concat(c.status,". Check if this is a CORS issue or if article is actually not found.")),console.warn("[API] Article ".concat(e," not found or not available (").concat(c.status,")")),null;return t&&console.error("[API] Safari: Failed to fetch feed ".concat(e,": ").concat(c.status,". Response headers:"),Object.fromEntries(c.headers.entries())),console.warn("[API] Failed to fetch feed ".concat(e,": ").concat(c.status)),null}let s=c.headers.get("content-type");s&&s.includes("application/json")||console.warn("[API] Unexpected content type: ".concat(s,". Expected application/json"));let l=await c.json();return console.log("[API] Successfully fetched article ".concat(e,":"),l.title),l}catch(t){if(t instanceof Error){let n=/^((?!chrome|android).)*safari/i.test(window.navigator.userAgent);"AbortError"===t.name||t.message.includes("timeout")||t.message.includes("TIMED_OUT")?console.warn("[API] Connection timeout while fetching article ".concat(e," - backend may be unavailable")):t.message.includes("Failed to fetch")||t.message.includes("ERR_CONNECTION")||t.message.includes("NetworkError")?n?console.error("[API] Safari CORS/Network error while fetching article ".concat(e,". This might be a CORS configuration issue. Error:"),t.message):console.warn("[API] Connection error while fetching article ".concat(e," - backend may be unavailable")):t.message.includes("CORS")||t.message.includes("cross-origin")?console.error("[API] CORS error while fetching article ".concat(e,". Check backend CORS configuration. Error:"),t.message):console.warn("[API] Error fetching feed ".concat(e,":"),t.message)}else console.warn("[API] Unknown error fetching feed ".concat(e,":"),t);return null}}async function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;try{let o=new AbortController,a=setTimeout(()=>o.abort(),1e4),i=await fetch("".concat(r,"/api/v1/feeds/").concat(e,"/comments?page=").concat(t,"&size=").concat(n),{method:"GET",cache:"default",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:o.signal});if(clearTimeout(a),!i.ok)return console.warn("[API] Failed to fetch comments for feed ".concat(e,": ").concat(i.status)),[];return(await i.json()).content||[]}catch(t){return t instanceof Error?"AbortError"===t.name||t.message.includes("timeout")?console.warn("[API] Connection timeout while fetching comments for feed ".concat(e)):console.warn("[API] Error fetching comments for feed ".concat(e,":"),t.message):console.warn("[API] Unknown error fetching comments for feed ".concat(e,":"),t),[]}}async function d(){try{let e=new AbortController,t=setTimeout(()=>e.abort(),1e4),n=await fetch("".concat(r,"/api/v1/categories"),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:e.signal});if(clearTimeout(t),!n.ok)return console.warn("[API] Failed to fetch categories:",n.status),[];let o=await n.json();if(Array.isArray(o))return o;if(Array.isArray(null==o?void 0:o.content))return o.content;if(Array.isArray(null==o?void 0:o.categories))return o.categories;return[]}catch(e){return e instanceof Error&&"AbortError"===e.name?console.warn("[API] Categories request timed out"):console.warn("[API] Error fetching categories",e),[]}}async function h(){try{console.log("[API] Fetching all categories from:","".concat(r,"/api/v1/categories"));let e=new AbortController,t=setTimeout(()=>e.abort(),1e4),n=await fetch("".concat(r,"/api/v1/categories"),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:e.signal});if(clearTimeout(t),console.log("[API] All categories response status:",n.status),!n.ok){console.warn("[API] Failed to fetch all categories:",n.status,n.statusText);let e=await n.text();return console.warn("[API] Error response body:",e),[]}let o=await n.json();if(console.log("[API] All categories data received:",o),Array.isArray(o))return console.log("[API] Returning",o.length,"top-level categories"),o;if(Array.isArray(null==o?void 0:o.content))return console.log("[API] Returning",o.content.length,"categories from content"),o.content;if(Array.isArray(null==o?void 0:o.categories))return console.log("[API] Returning",o.categories.length,"categories from categories"),o.categories;return console.warn("[API] Unexpected data format:",o),[]}catch(e){return e instanceof Error&&"AbortError"===e.name?console.warn("[API] All categories request timed out"):console.error("[API] Error fetching all categories",e),[]}}async function g(e){let t=new AbortController,n=setTimeout(()=>t.abort(),15e3);try{let o=await fetch("".concat(r,"/api/v1/auth/signup"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e),signal:t.signal});if(clearTimeout(n),!o.ok){let e=await o.text();throw Error(e||"Unable to sign up right now")}return o.json()}catch(e){if(clearTimeout(n),e instanceof Error&&"AbortError"===e.name)throw Error("Signup timed out, please try again");throw e instanceof Error?e:Error("Unknown signup error")}}async function m(e){let t=new AbortController,n=setTimeout(()=>t.abort(),15e3);try{let o=await fetch("".concat(r,"/api/v1/auth/signin"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e),signal:t.signal});if(clearTimeout(n),!o.ok){let e=await o.text();throw Error(e||"Unable to sign in right now")}return o.json()}catch(e){if(clearTimeout(n),e instanceof Error&&"AbortError"===e.name)throw Error("Sign in timed out, please try again");throw e instanceof Error?e:Error("Unknown sign in error")}}async function p(e){let t=new AbortController,n=setTimeout(()=>t.abort(),1e4);try{var o,a,i;let c=await fetch("".concat(r,"/api/v1/user/username/").concat(encodeURIComponent(e)),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:t.signal});if(clearTimeout(n),c.ok){let e=await c.json();return{available:!0,message:(null==e?void 0:null===(o=e.data)||void 0===o?void 0:o.message)||"Username is available"}}let s="Username is not available";try{let e=await c.json();s=(null==e?void 0:null===(a=e.error)||void 0===a?void 0:a.message)||(null==e?void 0:e.message)||(null==e?void 0:null===(i=e.data)||void 0===i?void 0:i.message)||s}catch(e){try{s=await c.text()||s}catch(e){}}if(403===c.status)return{available:!1,message:s};return c.status,{available:!1,message:s}}catch(e){throw clearTimeout(n),e instanceof Error?e:Error("Unable to check username")}}async function w(e){let t=new AbortController,n=setTimeout(()=>t.abort(),1e4);try{var o,a,i;let c=await fetch("".concat(r,"/api/v1/user/email/").concat(encodeURIComponent(e)),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:t.signal});if(clearTimeout(n),c.ok){let e=await c.json();return{available:!0,message:(null==e?void 0:null===(o=e.data)||void 0===o?void 0:o.message)||"Email is available"}}let s="Email is not available";try{let e=await c.json();s=(null==e?void 0:null===(a=e.error)||void 0===a?void 0:a.message)||(null==e?void 0:e.message)||(null==e?void 0:null===(i=e.data)||void 0===i?void 0:i.message)||s}catch(e){try{s=await c.text()||s}catch(e){}}if(403===c.status)return{available:!1,message:s||"Email is already registered"};if(400===c.status)return{available:!1,message:s||"Invalid email format"};return{available:!1,message:s}}catch(e){throw clearTimeout(n),e instanceof Error?e:Error("Unable to check email")}}},257:function(e,t,n){"use strict";var r,o;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(4227)},4227:function(e){!function(){var t={229:function(e){var t,n,r,o=e.exports={};function a(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var s=[],l=!1,u=-1;function f(){l&&r&&(l=!1,r.length?s=r.concat(s):u=-1,s.length&&d())}function d(){if(!l){var e=c(f);l=!0;for(var t=s.length;t;){for(r=s,s=[];++u<t;)r&&r[u].run();u=-1,t=s.length}r=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new h(e,t)),1!==s.length||l||c(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}},i=!0;try{t[e](a,a.exports,r),i=!1}finally{i&&delete n[e]}return a.exports}r.ab="//";var o=r(229);e.exports=o}()}}]);