(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8427],{9814:function(e,t,a){Promise.resolve().then(a.bind(a,3535))},3535:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var s=a(7437),n=a(2265),r=a(9376),i=a(3738),l=a.n(i);let c=[{key:"overview",label:"Overview",description:"Live operations summary"},{key:"users",label:"Users",description:"Manage user base"},{key:"feeds",label:"Feeds",description:"Approve pending stories"},{key:"reports",label:"Reports",description:"Activity & audit logs"}];function o(e){let{activeTab:t,onChangeTab:a,children:n}=e;return(0,s.jsxs)("div",{className:l().layout,children:[(0,s.jsxs)("aside",{className:l().sidebar,children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:l().brand,children:"Patreek Admin"}),(0,s.jsx)("p",{className:l().tagline,children:"Operational control center"})]}),(0,s.jsx)("nav",{className:l().nav,"aria-label":"Admin navigation",children:c.map(e=>(0,s.jsxs)("button",{type:"button",className:l().navButton,"aria-pressed":t===e.key,onClick:()=>a(e.key),children:[(0,s.jsx)("span",{className:l().navLabel,children:e.label}),(0,s.jsx)("span",{"aria-hidden":!0,children:"↗"})]},e.key))})]}),(0,s.jsx)("main",{className:l().contentArea,children:n})]})}var d=a(7029),u=a(7227),p=a.n(u),m=a(4940),h=a.n(m);function _(e){let{status:t,className:a=""}=e,n=(null==t?void 0:t.toLowerCase())||"unknown",r=h().neutral;return["active","approved","published","resolved","unlocked"].includes(n)?r=h().success:["banned","rejected","suspended","deleted","locked"].includes(n)?r=h().danger:["pending","review","warning"].includes(n)&&(r=h().warning),(0,s.jsx)("span",{className:"".concat(h().badge," ").concat(r," ").concat(a),children:t})}let g=e=>{if(!e)return"—";let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})},x=e=>{if(!e)return"";let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"})},v=e=>{let t=Date.now()-864e5,a=new Set;return e.forEach(e=>{var s,n,r,i,l,c;let o=e.createdAt?new Date(e.createdAt).getTime():NaN;if(Number.isNaN(o)||o<t)return;let d=null!==(c=null!==(l=null!==(i=null===(r=e.metadata)||void 0===r?void 0:null===(n=r.userId)||void 0===n?void 0:null===(s=n.toString)||void 0===s?void 0:s.call(n))&&void 0!==i?i:e.targetId)&&void 0!==l?l:e.adminIp)&&void 0!==c?c:"".concat(e.actionType,"-").concat(e.id);a.add(d)}),Math.max(a.size,0)},f=e=>{if(!e)return"PU";let t=e.trim().split(" ").filter(Boolean);return t.length?t.slice(0,2).map(e=>e[0].toUpperCase()).join(""):"PU"};function b(){let e=(0,r.useRouter)(),[t,a]=(0,n.useState)(!0),[i,l]=(0,n.useState)(!1),[c,u]=(0,n.useState)("overview"),[m,h]=(0,n.useState)({totalUsers:0,dailyActive:0,pendingFeeds:0}),[b,j]=(0,n.useState)(!1),[N,y]=(0,n.useState)(""),[T,S]=(0,n.useState)([]),[w,L]=(0,n.useState)(!1),[A,k]=(0,n.useState)(""),[B,U]=(0,n.useState)([]),[C,D]=(0,n.useState)(!1),[P,E]=(0,n.useState)(""),[F,H]=(0,n.useState)([]),[V,I]=(0,n.useState)(!1),[O,G]=(0,n.useState)(""),[M,R]=(0,n.useState)(null),[z,W]=(0,n.useState)(null),q=(0,n.useCallback)(async()=>{try{if(!await (0,d.ng)()){e.replace("/admin/passcode");return}l(!0)}catch(t){console.error("Unable to verify admin session",t),e.replace("/admin/passcode")}finally{a(!1)}},[e]);(0,n.useEffect)(()=>{q()},[q]);let J=(0,n.useCallback)(async()=>{let e=await (0,d.jV)(0,25),t=e.content.filter(e=>!e.published);return U(t),{page:e,pending:t}},[]),K=(0,n.useCallback)(async()=>{let e=await (0,d.sv)(0,25);return H(e.content),e},[]),Q=(0,n.useCallback)(async()=>{j(!0),y("");try{let[e,t,a]=await Promise.all([(0,d.Fd)(0,1),J(),K()]);h({totalUsers:e.totalElements,dailyActive:v(a.content),pendingFeeds:t.pending.length})}catch(e){console.error("Unable to load overview metrics",e),y("Unable to load overview metrics right now.")}finally{j(!1)}},[K,J]),X=(0,n.useCallback)(async()=>{L(!0),k("");try{let e=await (0,d.Fd)(0,20);S(e.content)}catch(e){console.error("Unable to load users",e),k("Unable to load user list.")}finally{L(!1)}},[]),Y=(0,n.useCallback)(async()=>{D(!0),E("");try{await J()}catch(e){console.error("Unable to load feeds",e),E("Unable to load pending feeds.")}finally{D(!1)}},[J]),Z=(0,n.useCallback)(async()=>{I(!0),G("");try{await K()}catch(e){console.error("Unable to load reports",e),G("Unable to load activity logs.")}finally{I(!1)}},[K]);(0,n.useEffect)(()=>{i&&("overview"===c?Q():"users"===c?X():"feeds"===c?Y():"reports"===c&&Z())},[c,i,Q,X,Y,Z]);let $=(0,n.useCallback)(async e=>{R(e.id);try{e.suspended?await (0,d.eH)(e.id):await (0,d.qB)(e.id,"Policy review"),await X()}catch(e){console.error("Unable to update user status",e)}finally{R(null)}},[X]),ee=(0,n.useCallback)(async e=>{W(e);try{await (0,d.VG)(e,!0);let{pending:t}=await J();h(e=>({...e,pendingFeeds:t.length}))}catch(e){console.error("Failed to approve feed",e),E("Unable to approve feed.")}finally{W(null)}},[J]);return t?(0,s.jsx)("div",{className:p().emptyState,children:(0,s.jsx)("p",{children:"Verifying admin access…"})}):i?(0,s.jsxs)(o,{activeTab:c,onChangeTab:u,children:["overview"===c&&(0,s.jsxs)("section",{className:p().section,children:[(0,s.jsxs)("div",{className:p().sectionHeader,children:[(0,s.jsx)("h2",{className:p().sectionTitle,children:"Overview"}),(0,s.jsx)("p",{className:p().sectionSubtitle,children:"Pulse on the platform and outstanding items."})]}),N&&(0,s.jsx)("p",{className:p().messageTag,children:N}),(0,s.jsxs)("div",{className:p().statsGrid,children:[(0,s.jsxs)("div",{className:p().statCard,children:[(0,s.jsx)("p",{className:p().statLabel,children:"Total Users"}),(0,s.jsx)("p",{className:p().statValue,children:b?"Loading…":m.totalUsers.toLocaleString()}),(0,s.jsx)("p",{className:p().statSubtext,children:"Registered Patreek accounts."})]}),(0,s.jsxs)("div",{className:p().statCard,children:[(0,s.jsx)("p",{className:p().statLabel,children:"Daily Active"}),(0,s.jsx)("p",{className:p().statValue,children:b?"Loading…":m.dailyActive.toLocaleString()}),(0,s.jsx)("p",{className:p().statSubtext,children:"Unique actors in the last 24 hours."})]}),(0,s.jsxs)("div",{className:p().statCard,children:[(0,s.jsx)("p",{className:p().statLabel,children:"Pending Feeds"}),(0,s.jsx)("p",{className:p().statValue,children:b?"Loading…":m.pendingFeeds.toLocaleString()}),(0,s.jsx)("p",{className:p().statSubtext,children:"Waiting on editorial approval."})]})]}),(0,s.jsxs)("div",{className:p().sectionHeader,style:{marginTop:"1.75rem"},children:[(0,s.jsx)("h3",{className:p().sectionTitle,children:"Pending stories snapshot"}),(0,s.jsx)("p",{className:p().sectionSubtitle,children:"Quick peek at the latest submissions."})]}),0===B.length?(0,s.jsx)("div",{className:p().emptyState,children:"No pending feeds at this time."}):(0,s.jsx)("ul",{className:p().feedList,children:B.slice(0,3).map(e=>(0,s.jsxs)("li",{className:p().feedItem,children:[(0,s.jsxs)("div",{className:p().feedContent,children:[(0,s.jsx)("p",{className:p().feedTitle,children:e.title||"Untitled story"}),(0,s.jsxs)("p",{className:p().feedMeta,children:[e.categoryName||"Uncategorized"," \xb7 ",g(e.createdAt)]}),(0,s.jsx)("p",{className:p().feedExcerpt,children:e.excerpt||e.body||"No summary available."})]}),(0,s.jsx)("div",{className:p().feedActions,children:(0,s.jsx)("button",{type:"button",className:"".concat(p().actionButton," ").concat(p().approveButton),disabled:z===e.id,onClick:()=>ee(e.id),children:z===e.id?"Approving…":"Approve now"})})]},e.id))})]}),"users"===c&&(0,s.jsxs)("section",{className:p().section,children:[(0,s.jsxs)("div",{className:p().sectionHeader,children:[(0,s.jsx)("h2",{className:p().sectionTitle,children:"Users"}),(0,s.jsx)("p",{className:p().sectionSubtitle,children:"Monitor accounts and ban problematic actors."})]}),A&&(0,s.jsx)("p",{className:p().messageTag,children:A}),(0,s.jsx)("div",{className:p().tableWrapper,children:w?(0,s.jsx)("p",{className:p().metaText,children:"Loading user data…"}):0===T.length?(0,s.jsx)("p",{className:p().emptyState,children:"No users found."}):(0,s.jsxs)("table",{className:p().table,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Avatar"}),(0,s.jsx)("th",{children:"Username"}),(0,s.jsx)("th",{children:"Email"}),(0,s.jsx)("th",{children:"Joined"}),(0,s.jsx)("th",{children:"Status"}),(0,s.jsx)("th",{children:"Action"})]})}),(0,s.jsx)("tbody",{children:T.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("div",{className:p().avatarCell,children:(0,s.jsx)("span",{className:p().avatarBubble,children:f(e.name||e.username)})})}),(0,s.jsxs)("td",{children:[(0,s.jsx)("p",{className:p().userName,children:e.username||"Unknown"}),(0,s.jsx)("p",{className:p().metaText,children:e.headline||"No headline"})]}),(0,s.jsx)("td",{children:e.email||"—"}),(0,s.jsx)("td",{children:g(e.createdAt)}),(0,s.jsx)("td",{children:(0,s.jsx)(_,{status:e.suspended?"Suspended":"Active"})}),(0,s.jsx)("td",{children:(0,s.jsx)("button",{type:"button",className:"".concat(p().actionButton," ").concat(e.suspended?p().secondaryButton:p().approveButton),onClick:()=>$(e),disabled:M===e.id,children:M===e.id?"Updating…":e.suspended?"Unban":"Ban"})})]},e.id))})]})})]}),"feeds"===c&&(0,s.jsxs)("section",{className:p().section,children:[(0,s.jsxs)("div",{className:p().sectionHeader,children:[(0,s.jsx)("h2",{className:p().sectionTitle,children:"Feeds"}),(0,s.jsx)("p",{className:p().sectionSubtitle,children:"Approve submitted content before it goes live."})]}),P&&(0,s.jsx)("p",{className:p().messageTag,children:P}),C&&(0,s.jsx)("p",{className:p().metaText,children:"Loading pending feeds…"}),!C&&0===B.length&&(0,s.jsx)("div",{className:p().emptyState,children:"No pending feeds."}),!C&&B.length>0&&(0,s.jsx)("ul",{className:p().feedList,children:B.map(e=>(0,s.jsxs)("li",{className:p().feedItem,children:[(0,s.jsxs)("div",{className:p().feedContent,children:[(0,s.jsx)("p",{className:p().feedTitle,children:e.title||"Untitled story"}),(0,s.jsxs)("p",{className:p().feedMeta,children:[e.categoryName||"Uncategorized"," \xb7 ",g(e.createdAt)]}),(0,s.jsx)("p",{className:p().feedExcerpt,children:e.excerpt||e.body||"No summary available."})]}),(0,s.jsx)("div",{className:p().feedActions,children:(0,s.jsx)("button",{type:"button",className:"".concat(p().actionButton," ").concat(p().approveButton),disabled:z===e.id,onClick:()=>ee(e.id),children:z===e.id?"Approving…":"Approve"})})]},e.id))})]}),"reports"===c&&(0,s.jsxs)("section",{className:p().section,children:[(0,s.jsxs)("div",{className:p().sectionHeader,children:[(0,s.jsx)("h2",{className:p().sectionTitle,children:"Reports"}),(0,s.jsx)("p",{className:p().sectionSubtitle,children:"Action logs for transparency."})]}),O&&(0,s.jsx)("p",{className:p().messageTag,children:O}),V&&(0,s.jsx)("p",{className:p().metaText,children:"Loading activity…"}),!V&&0===F.length&&(0,s.jsx)("div",{className:p().emptyState,children:"No activity recorded."}),!V&&F.length>0&&(0,s.jsx)("ul",{className:p().reportsList,children:F.slice(0,12).map(e=>(0,s.jsxs)("li",{className:p().reportItem,children:[(0,s.jsxs)("div",{className:p().reportDetails,children:[(0,s.jsx)("p",{className:p().reportTitle,children:e.actionType}),(0,s.jsx)("p",{className:p().reportDescription,children:e.actionDescription}),e.targetType&&(0,s.jsx)("span",{className:p().messageTag,children:e.targetType})]}),(0,s.jsx)("span",{className:p().reportTime,children:x(e.createdAt)})]},e.id))})]})]}):null}},9376:function(e,t,a){"use strict";var s=a(5475);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},257:function(e,t,a){"use strict";var s,n;e.exports=(null==(s=a.g.process)?void 0:s.env)&&"object"==typeof(null==(n=a.g.process)?void 0:n.env)?a.g.process:a(4227)},4227:function(e){!function(){var t={229:function(e){var t,a,s,n=e.exports={};function r(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(a){try{return t.call(null,e,0)}catch(a){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var c=[],o=!1,d=-1;function u(){o&&s&&(o=!1,s.length?c=s.concat(c):d=-1,c.length&&p())}function p(){if(!o){var e=l(u);o=!0;for(var t=c.length;t;){for(s=c,c=[];++d<t;)s&&s[d].run();d=-1,t=c.length}s=null,o=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function h(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];c.push(new m(e,t)),1!==c.length||o||l(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=h,n.addListener=h,n.once=h,n.off=h,n.removeListener=h,n.removeAllListeners=h,n.emit=h,n.prependListener=h,n.prependOnceListener=h,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},a={};function s(e){var n=a[e];if(void 0!==n)return n.exports;var r=a[e]={exports:{}},i=!0;try{t[e](r,r.exports,s),i=!1}finally{i&&delete a[e]}return r.exports}s.ab="//";var n=s(229);e.exports=n}()},7227:function(e){e.exports={section:"page_section__0vFvZ",sectionHeader:"page_sectionHeader__V9PCb",sectionTitle:"page_sectionTitle___hD3M",sectionSubtitle:"page_sectionSubtitle___ioDP",statsGrid:"page_statsGrid__5WwGp",statCard:"page_statCard__1_AoP",statLabel:"page_statLabel__0Kojj",statValue:"page_statValue__BGuK9",statSubtext:"page_statSubtext__xtP3S",tableWrapper:"page_tableWrapper__HncOo",table:"page_table__u9B_t",avatarCell:"page_avatarCell__rbxhD",avatarBubble:"page_avatarBubble__UVX2_",userName:"page_userName__m4hMd",metaText:"page_metaText__TaSv0",statusBadge:"page_statusBadge__mJjD_",statusActive:"page_statusActive__TR2Vx",statusSuspended:"page_statusSuspended__Ddwjs",actionButton:"page_actionButton__hA3N2",approveButton:"page_approveButton__qazZG",secondaryButton:"page_secondaryButton__oU12F",feedList:"page_feedList__CYE2B",feedItem:"page_feedItem__J77qN",feedContent:"page_feedContent__FA5y3",feedTitle:"page_feedTitle__3505i",feedMeta:"page_feedMeta__8B5UP",feedExcerpt:"page_feedExcerpt__XlwwG",feedActions:"page_feedActions__L3apm",reportsList:"page_reportsList__HlYHk",reportItem:"page_reportItem__Z_hHa",reportDetails:"page_reportDetails___2K7s",reportTitle:"page_reportTitle__D4lay",reportDescription:"page_reportDescription__Ixjz5",reportTime:"page_reportTime__0Skp0",emptyState:"page_emptyState__76Nzm",messageTag:"page_messageTag__scbT3"}},3738:function(e){e.exports={layout:"DashboardLayout_layout__DnJDz",sidebar:"DashboardLayout_sidebar__RmWs8",brand:"DashboardLayout_brand__FBQOW",tagline:"DashboardLayout_tagline__dUxyk",nav:"DashboardLayout_nav__AisF2",navButton:"DashboardLayout_navButton__UiqeH",navLabel:"DashboardLayout_navLabel__2__hF",contentArea:"DashboardLayout_contentArea__orCb5"}},4940:function(e){e.exports={badge:"StatusBadge_badge__h7A0V",success:"StatusBadge_success__rsO4J",danger:"StatusBadge_danger__XaGmQ",warning:"StatusBadge_warning__PFKmV",neutral:"StatusBadge_neutral__EY7DO"}}},function(e){e.O(0,[5052,7029,2971,2117,1744],function(){return e(e.s=9814)}),_N_E=e.O()}]);