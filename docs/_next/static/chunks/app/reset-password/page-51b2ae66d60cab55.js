(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2363],{4669:function(e,t,a){Promise.resolve().then(a.bind(a,878))},878:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var n=a(7437),r=a(2265),s=a(7648),i=a(9376),o=a(1224),c=a(556),l=a.n(c);function u(){let e=(0,i.useSearchParams)(),t=(0,i.useRouter)(),[a,c]=(0,r.useState)(""),[u,d]=(0,r.useState)(""),[h,p]=(0,r.useState)(""),[f,m]=(0,r.useState)(!1),[_,v]=(0,r.useState)(""),[b,x]=(0,r.useState)("");(0,r.useEffect)(()=>{c((null==e?void 0:e.get("token"))||"")},[e]);let g=async e=>{if(e.preventDefault(),x(""),v(""),!a){x("Reset link is missing or invalid.");return}if(u.length<8){x("Password must be at least 8 characters.");return}if(u!==h){x("Passwords do not match.");return}m(!0);try{let e=await fetch("/api/v1/auth/reset-confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a,newPassword:u})});if(!e.ok){let t=await e.json().catch(()=>({}));throw Error((null==t?void 0:t.message)||"Unable to reset password. The link may have expired.")}v("Password updated successfully. You can sign in with your new password."),setTimeout(()=>t.push("/registration"),1200)}catch(e){x((null==e?void 0:e.message)||"Unable to reset password. The link may have expired.")}finally{m(!1)}};return(0,n.jsxs)("div",{className:l().page,children:[(0,n.jsx)(o.Z,{}),(0,n.jsx)("div",{className:l().content,children:(0,n.jsxs)("div",{className:l().card,children:[(0,n.jsx)("h1",{className:l().title,children:"Set a new password"}),(0,n.jsx)("p",{className:l().subtitle,children:"Create a strong password to secure your account."}),(0,n.jsxs)("form",{className:l().form,onSubmit:g,children:[(0,n.jsxs)("label",{className:l().label,children:["New password",(0,n.jsx)("input",{className:l().input,type:"password",value:u,onChange:e=>d(e.target.value),placeholder:"••••••••",required:!0})]}),(0,n.jsxs)("label",{className:l().label,children:["Confirm password",(0,n.jsx)("input",{className:l().input,type:"password",value:h,onChange:e=>p(e.target.value),placeholder:"••••••••",required:!0})]}),(0,n.jsx)("button",{className:l().button,type:"submit",disabled:f,children:f?"Saving...":"Update password"})]}),_&&(0,n.jsx)("div",{className:"".concat(l().card," ").concat(l().success),children:_}),b&&(0,n.jsx)("div",{className:"".concat(l().card," ").concat(l().error),children:b}),(0,n.jsxs)("p",{className:l().note,children:["Done? ",(0,n.jsx)(s.default,{className:l().link,href:"/registration",children:"Go to sign in"})]})]})})]})}function d(){return(0,n.jsx)(r.Suspense,{fallback:(0,n.jsxs)("div",{className:l().page,children:[(0,n.jsx)(o.Z,{}),(0,n.jsx)("div",{className:l().content,children:"Loading..."})]}),children:(0,n.jsx)(u,{})})}},1224:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var n=a(7437),r=a(2265),s=a(7648),i=a(9376),o=a(6914),c=a.n(o),l=a(7029);function u(e){let{hasSession:t=!1,active:a}=e,o=(0,i.useRouter)(),u=(0,i.usePathname)(),[h,p]=(0,r.useState)(null),[f,m]=(0,r.useState)(!1),[_,v]=(0,r.useState)(null),b=(0,r.useMemo)(()=>null==a?void 0:a.toLowerCase(),[a]),x=[{label:"Coins",path:"/coins"},{label:"Community",path:"/community"},{label:"Shop",path:"https://shop.patreek.com"},{label:"Opinion",path:"/opinion"},{label:"Write",path:"/write"}];(0,r.useEffect)(()=>{(async()=>{if(t)try{if(!(await (0,l.r$)()).authenticated)return;let e=await (0,l.getUserProfile)();(null==e?void 0:e.username)&&p(e.username)}catch(e){p(null)}})()},[t]),(0,r.useEffect)(()=>{let e=!1;return(async()=>{try{let t=await (0,l.$0)();!e&&t&&Number.isFinite(t.unitPrice)&&v(t.unitPrice)}catch(e){console.warn("[Header] Failed to load Pat Coin price",e)}})(),()=>{e=!0}},[]);let g=e=>!!(b&&b===e.label.toLowerCase()||u&&e.path.startsWith("/")&&u.startsWith(e.path)),j=(0,r.useMemo)(()=>{let e=null!=_?_:.01;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:4}).format(e)},[_]);return(0,n.jsxs)("header",{className:c().header,children:[(0,n.jsx)("div",{className:c().brand,onClick:()=>o.push("/"),children:"Patreek"}),(0,n.jsx)("nav",{className:c().nav,children:x.map(e=>(0,n.jsx)(s.default,{href:e.path,className:"".concat(c().navLink," ").concat(g(e)?c().activeLink:""),target:e.path.startsWith("http")?"_blank":void 0,children:e.label},e.label))}),(0,n.jsxs)("div",{className:c().actions,children:[(0,n.jsxs)(s.default,{href:"/coins",className:c().coinWidget,"aria-label":"Open Pat Coins — 1 P equals ".concat(j),children:[(0,n.jsx)(d,{className:c().coinIcon}),(0,n.jsxs)("div",{className:c().coinText,children:[(0,n.jsx)("span",{className:c().coinLabel,children:"Pat Coin"}),(0,n.jsxs)("span",{className:c().coinValue,children:["1\xa0P = ",j]})]})]}),(0,n.jsx)("button",{type:"button",className:c().profileCircle,onClick:()=>{t&&h?o.push("/u/".concat(h)):o.push("/registration")},"aria-label":"Open profile",children:h?h[0].toUpperCase():"P"}),(0,n.jsxs)("button",{type:"button",className:c().hamburger,onClick:()=>m(e=>!e),"aria-label":"Toggle navigation",children:[(0,n.jsx)("span",{}),(0,n.jsx)("span",{}),(0,n.jsx)("span",{})]})]}),f&&(0,n.jsx)("div",{className:c().mobileNav,children:x.map(e=>(0,n.jsx)(s.default,{href:e.path,className:c().mobileNavItem,onClick:()=>m(!1),children:e.label},e.label))})]})}function d(e){let{className:t}=e,a=(0,r.useId)();return(0,n.jsxs)("svg",{className:t,viewBox:"0 0 32 32",role:"presentation","aria-hidden":"true",focusable:"false",children:[(0,n.jsx)("defs",{children:(0,n.jsxs)("linearGradient",{id:a,x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,n.jsx)("stop",{offset:"0%",stopColor:"#a855f7"}),(0,n.jsx)("stop",{offset:"45%",stopColor:"#6366f1"}),(0,n.jsx)("stop",{offset:"100%",stopColor:"#2563eb"})]})}),(0,n.jsx)("circle",{cx:"16",cy:"16",r:"15",fill:"url(#".concat(a,")")}),(0,n.jsx)("circle",{cx:"16",cy:"16",r:"14",fill:"none",stroke:"rgba(255,255,255,0.35)",strokeWidth:"1.5"}),(0,n.jsx)("path",{d:"M11.5 9h6.2c3 0 5.3 2.2 5.3 4.9 0 2.6-2.3 4.9-5.3 4.9h-3.1v4.2h-3.1V9zm6 7.1c1.3 0 2.2-.9 2.2-2.1s-.9-2-2.2-2h-2.9v4.1z",fill:"#fff"})]})}},7648:function(e,t,a){"use strict";a.d(t,{default:function(){return r.a}});var n=a(2972),r=a.n(n)},9376:function(e,t,a){"use strict";var n=a(5475);a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}}),a.o(n,"useSearchParams")&&a.d(t,{useSearchParams:function(){return n.useSearchParams}})},257:function(e,t,a){"use strict";var n,r;e.exports=(null==(n=a.g.process)?void 0:n.env)&&"object"==typeof(null==(r=a.g.process)?void 0:r.env)?a.g.process:a(4227)},4227:function(e){!function(){var t={229:function(e){var t,a,n,r=e.exports={};function s(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(a){try{return t.call(null,e,0)}catch(a){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var c=[],l=!1,u=-1;function d(){l&&n&&(l=!1,n.length?c=n.concat(c):u=-1,c.length&&h())}function h(){if(!l){var e=o(d);l=!0;for(var t=c.length;t;){for(n=c,c=[];++u<t;)n&&n[u].run();u=-1,t=c.length}n=null,l=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];c.push(new p(e,t)),1!==c.length||l||o(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},a={};function n(e){var r=a[e];if(void 0!==r)return r.exports;var s=a[e]={exports:{}},i=!0;try{t[e](s,s.exports,n),i=!1}finally{i&&delete a[e]}return s.exports}n.ab="//";var r=n(229);e.exports=r}()},556:function(e){e.exports={page:"page_page__p5qk2",content:"page_content__fmxWV",card:"page_card__fxLP0",title:"page_title__N9kyP",subtitle:"page_subtitle__ID5_S",form:"page_form__tzXkl",label:"page_label__nPczt",input:"page_input__Ovt1H",button:"page_button__MzskL",success:"page_success__UrA_4",error:"page_error__bc4wz",note:"page_note__d2ZVQ",link:"page_link__5fTrq"}},6914:function(e){e.exports={header:"MainHeader_header__v29oY",brand:"MainHeader_brand__PWSjn",nav:"MainHeader_nav__OWvbh",navLink:"MainHeader_navLink__NUd27",activeLink:"MainHeader_activeLink__YR7BN",actions:"MainHeader_actions__jUZ_j",coinWidget:"MainHeader_coinWidget__Lwamz",coinIcon:"MainHeader_coinIcon__GoTN_",coinText:"MainHeader_coinText__soICt",coinLabel:"MainHeader_coinLabel__rEQWV",coinValue:"MainHeader_coinValue__U9zIq",profileCircle:"MainHeader_profileCircle__654Xs",hamburger:"MainHeader_hamburger__9fVCh",mobileNav:"MainHeader_mobileNav__RVDMJ",mobileNavItem:"MainHeader_mobileNavItem__n0yAB"}}},function(e){e.O(0,[4937,2972,7029,2971,2117,1744],function(){return e(e.s=4669)}),_N_E=e.O()}]);