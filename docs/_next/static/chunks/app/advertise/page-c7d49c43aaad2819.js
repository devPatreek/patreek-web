(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3665],{8791:function(e,t,a){Promise.resolve().then(a.bind(a,457))},457:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var r=a(7437),n=a(2265),s=a(7648),i=a(1224),o=a(7029),l=a(87),u=a.n(l);let c=[{id:"1h",label:"1 hour",durationHours:1,priceCoins:1e3,description:"Morning blast to light up a trending slot."},{id:"3h",label:"3 hours",durationHours:3,priceCoins:2600,description:"Sustain attention for a full news cycle."},{id:"24h",label:"24 hours",durationHours:24,priceCoins:9e3,description:"Command a whole-day premium placement."}];function d(){var e,t;let[a,l]=(0,n.useState)(null),[d,p]=(0,n.useState)(c),[h,m]=(0,n.useState)(c[0].id),[_,f]=(0,n.useState)("https://"),[g,b]=(0,n.useState)(null),[v,y]=(0,n.useState)(null),[x,j]=(0,n.useState)(null),[N,C]=(0,n.useState)("idle"),[w,L]=(0,n.useState)(""),[S,k]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=!0;return(0,o.getUserProfile)().then(t=>{e&&l(t)}),()=>{e=!1}},[]),(0,n.useEffect)(()=>()=>{v&&URL.revokeObjectURL(v)},[v]),(0,n.useEffect)(()=>{let e=!1;return async function(){try{var t;let a=await fetch("/api/v1/ads/pricing",{cache:"no-store"});if(!a.ok)return;let r=await a.json(),n=Array.isArray(r.tiers)?r.tiers:Array.isArray(r)?r:null!==(t=null==r?void 0:r.tiers)&&void 0!==t?t:[];if(!n.length)return;let s=n.map(e=>({id:"tier-".concat(e.durationHours,"-").concat(e.priceCoins),label:e.label||"".concat(e.durationHours," hour").concat(e.durationHours>1?"s":""),durationHours:e.durationHours,priceCoins:e.priceCoins,description:e.description}));if(e)return;p(s),m(e=>s.some(t=>t.id===e)?e:s[0].id)}catch(e){console.warn("[Advertise] Failed to load pricing",e)}}(),()=>{e=!0}},[]);let H=(0,n.useMemo)(()=>{var e;return null!==(e=d.find(e=>e.id===h))&&void 0!==e?e:d[0]},[h,d]),R=null!==(e=null==a?void 0:a.coins)&&void 0!==e?e:0,P=H?Math.max(0,H.priceCoins-R):0,M=!!(H&&0===P),T="submitting"===N||!g||!_||!H||!M||!!x,U=async e=>{if(e.preventDefault(),H&&g){if(!M){C("error"),L("You need more coins to book this slot.");return}C("submitting"),L(""),k(null);try{let e=new FormData;e.append("durationHours",H.durationHours.toString()),e.append("targetUrl",_),e.append("costCoins",H.priceCoins.toString()),e.append("image",g);let t=await fetch("/api/v1/ads/book",{method:"POST",body:e,credentials:"include"});if(!t.ok){let e=await t.text();throw Error(e||"Unable to queue the slot.")}let a=await t.json().catch(()=>({})),r=a.startTime||a.start_at||a.queueTime,n=r?new Date(r).toLocaleString():"shortly";C("success"),k(n),L("Your ad is scheduled \uD83C\uDF89")}catch(e){C("error"),L(e instanceof Error?e.message:"Submit failed.")}}};return(0,r.jsxs)("div",{className:u().page,children:[(0,r.jsx)(i.Z,{hasSession:!!a}),(0,r.jsxs)("section",{className:u().hero,children:[(0,r.jsx)("p",{className:u().tag,children:"Advertising"}),(0,r.jsx)("h1",{className:u().title,children:"Book a premium news slot"}),(0,r.jsx)("p",{className:u().subtitle,children:"Spend your Pat Coins for curated exposure. Slots book in real time and queue automatically."})]}),(0,r.jsxs)("main",{className:u().layout,children:[(0,r.jsxs)("div",{className:u().profileSummary,children:[(0,r.jsx)("p",{className:u().summaryLabel,children:"Your Wallet"}),(0,r.jsxs)("p",{className:u().coins,children:[R.toLocaleString()," Pats"]}),(0,r.jsx)("p",{className:u().summaryCopy,children:"Coins update instantly when purchases or boosts occur."}),(0,r.jsx)(s.default,{href:"/coins",className:u().ctaLink,children:"Get more coins"})]}),(0,r.jsxs)("form",{className:u().form,onSubmit:U,children:[(0,r.jsx)("div",{className:u().grid,children:d.map(e=>{let t=!!H&&e.id===H.id;return(0,r.jsxs)("button",{type:"button",onClick:()=>m(e.id),className:"".concat(u().durationCard," ").concat(t?u().active:""),children:[(0,r.jsx)("p",{className:u().durationLabel,children:e.label}),(0,r.jsxs)("p",{className:u().durationCost,children:[e.priceCoins.toLocaleString()," Pats"]}),e.description&&(0,r.jsx)("p",{className:u().durationCopy,children:e.description})]},e.id)})}),(0,r.jsxs)("label",{className:u().field,children:[(0,r.jsx)("span",{className:u().label,children:"Target URL"}),(0,r.jsx)("input",{type:"url",placeholder:"https://yourbrand.com",value:_,onChange:e=>f(e.target.value),className:u().input,required:!0})]}),(0,r.jsxs)("label",{className:u().field,children:[(0,r.jsx)("span",{className:u().label,children:"Upload banner (4:1 ratio)"}),(0,r.jsxs)("div",{className:u().upload,children:[(0,r.jsx)("input",{type:"file",accept:"image/*",className:u().fileInput,onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a){b(null),y(null),j(null);return}let r=URL.createObjectURL(a),n=new Image;n.onload=()=>{Math.abs(n.width/n.height-4)>.4?(j("Please upload a 4:1 banner (wide and short)."),b(null),y(null),URL.revokeObjectURL(r)):(j(null),b(a),v&&URL.revokeObjectURL(v),y(r))},n.onerror=()=>{j("Unable to read the file."),URL.revokeObjectURL(r)},n.src=r},required:!0}),v?(0,r.jsx)("img",{src:v,alt:"Preview",className:u().preview}):(0,r.jsx)("p",{className:u().uploadHint,children:"Select an image (approx. 4:1 ratio)"})]}),x&&(0,r.jsx)("span",{className:u().error,children:x})]}),(0,r.jsxs)("div",{className:u().statusRow,children:[(0,r.jsx)("span",{className:u().label,children:"Slot cost"}),(0,r.jsxs)("span",{className:u().cost,children:[(null!==(t=null==H?void 0:H.priceCoins)&&void 0!==t?t:0).toLocaleString()," Pats"]})]}),(0,r.jsx)("button",{type:"submit",className:u().submit,disabled:T,children:"submitting"===N?"Queuing slotâ€¦":"Queue this slot"}),!M&&(0,r.jsxs)("p",{className:u().warning,children:["You need ",P.toLocaleString()," more coins. ",(0,r.jsx)(s.default,{href:"/coins",children:"Buy coins"}),"."]}),w&&(0,r.jsx)("p",{className:"".concat(u().statusMessage," ").concat("error"===N?u().error:u().success),children:w}),"success"===N&&S&&(0,r.jsxs)("p",{className:u().successCopy,children:["Your creative is queued for ",(0,r.jsx)("strong",{children:S}),"."]})]})]})]})}},1224:function(e,t,a){"use strict";a.d(t,{Z:function(){return c}});var r=a(7437),n=a(2265),s=a(7648),i=a(9376),o=a(6914),l=a.n(o),u=a(7029);function c(e){let{hasSession:t=!1,active:a}=e,o=(0,i.useRouter)(),c=(0,i.usePathname)(),[d,p]=(0,n.useState)(null),[h,m]=(0,n.useState)(!1),_=(0,n.useMemo)(()=>null==a?void 0:a.toLowerCase(),[a]),f=[{label:"Coins",path:"/coins"},{label:"Community",path:"/community"},{label:"Shop",path:"https://shop.patreek.com"},{label:"Opinion",path:"/opinion"},{label:"Write",path:"/write"}];(0,n.useEffect)(()=>{(async()=>{if(t)try{if(!(await (0,u.r$)()).authenticated)return;let e=await (0,u.getUserProfile)();(null==e?void 0:e.username)&&p(e.username)}catch(e){p(null)}})()},[t]);let g=e=>!!(_&&_===e.label.toLowerCase()||c&&e.path.startsWith("/")&&c.startsWith(e.path));return(0,r.jsxs)("header",{className:l().header,children:[(0,r.jsx)("div",{className:l().brand,onClick:()=>o.push("/"),children:"Patreek"}),(0,r.jsx)("nav",{className:l().nav,children:f.map(e=>(0,r.jsx)(s.default,{href:e.path,className:"".concat(l().navLink," ").concat(g(e)?l().activeLink:""),target:e.path.startsWith("http")?"_blank":void 0,children:e.label},e.label))}),(0,r.jsxs)("div",{className:l().actions,children:[(0,r.jsx)("button",{type:"button",className:l().iconButton,"aria-label":"Search Patreek",children:"\uD83D\uDD0D"}),(0,r.jsx)("button",{type:"button",className:l().profileCircle,onClick:()=>{t&&d?o.push("/u/".concat(d)):o.push("/registration")},"aria-label":"Open profile",children:d?d[0].toUpperCase():"P"}),(0,r.jsxs)("button",{type:"button",className:l().hamburger,onClick:()=>m(e=>!e),"aria-label":"Toggle navigation",children:[(0,r.jsx)("span",{}),(0,r.jsx)("span",{}),(0,r.jsx)("span",{})]})]}),h&&(0,r.jsx)("div",{className:l().mobileNav,children:f.map(e=>(0,r.jsx)(s.default,{href:e.path,className:l().mobileNavItem,onClick:()=>m(!1),children:e.label},e.label))})]})}},7648:function(e,t,a){"use strict";a.d(t,{default:function(){return n.a}});var r=a(2972),n=a.n(r)},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},257:function(e,t,a){"use strict";var r,n;e.exports=(null==(r=a.g.process)?void 0:r.env)&&"object"==typeof(null==(n=a.g.process)?void 0:n.env)?a.g.process:a(4227)},4227:function(e){!function(){var t={229:function(e){var t,a,r,n=e.exports={};function s(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(a){try{return t.call(null,e,0)}catch(a){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var l=[],u=!1,c=-1;function d(){u&&r&&(u=!1,r.length?l=r.concat(l):c=-1,l.length&&p())}function p(){if(!u){var e=o(d);u=!0;for(var t=l.length;t;){for(r=l,l=[];++c<t;)r&&r[c].run();c=-1,t=l.length}r=null,u=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];l.push(new h(e,t)),1!==l.length||u||o(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},a={};function r(e){var n=a[e];if(void 0!==n)return n.exports;var s=a[e]={exports:{}},i=!0;try{t[e](s,s.exports,r),i=!1}finally{i&&delete a[e]}return s.exports}r.ab="//";var n=r(229);e.exports=n}()},87:function(e){e.exports={page:"page_page__4Jl_O",hero:"page_hero__S2RY5",tag:"page_tag__SHobR",title:"page_title__Ihe9s",subtitle:"page_subtitle__KshdA",layout:"page_layout__8tNMC",profileSummary:"page_profileSummary__WRqoH",summaryLabel:"page_summaryLabel__PEoJU",coins:"page_coins__DEYNa",summaryCopy:"page_summaryCopy__PfeJW",ctaLink:"page_ctaLink__qRHom",form:"page_form__zWE3K",grid:"page_grid__9oaMA",durationCard:"page_durationCard__pRitN",active:"page_active__EHVPR",durationLabel:"page_durationLabel__edMLW",durationCost:"page_durationCost__Zxhg_",durationCopy:"page_durationCopy__Udaz8",field:"page_field__OH8Td",label:"page_label__5wyGc",input:"page_input__q6yqr",upload:"page_upload__OJ1__",fileInput:"page_fileInput__fPrXh",preview:"page_preview__76nj4",uploadHint:"page_uploadHint__IcM3L",statusRow:"page_statusRow__tgriQ",cost:"page_cost__cmEKO",submit:"page_submit__serTk",warning:"page_warning__9Ixnt",statusMessage:"page_statusMessage__nswR0",error:"page_error__J6WLV",success:"page_success__1uNZ8",successCopy:"page_successCopy__sOlim"}},6914:function(e){e.exports={header:"MainHeader_header__v29oY",brand:"MainHeader_brand__PWSjn",nav:"MainHeader_nav__OWvbh",navLink:"MainHeader_navLink__NUd27",activeLink:"MainHeader_activeLink__YR7BN",actions:"MainHeader_actions__jUZ_j",iconButton:"MainHeader_iconButton__6RFhG",profileCircle:"MainHeader_profileCircle__654Xs",hamburger:"MainHeader_hamburger__9fVCh",mobileNav:"MainHeader_mobileNav__RVDMJ",mobileNavItem:"MainHeader_mobileNavItem__n0yAB"}}},function(e){e.O(0,[7123,2972,7029,2971,2117,1744],function(){return e(e.s=8791)}),_N_E=e.O()}]);