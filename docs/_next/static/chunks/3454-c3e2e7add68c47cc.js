(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3454],{5148:function(e,t,r){"use strict";r.d(t,{Z:function(){return _}});var a=r(7437),n=r(2265),l=r(3145),c=r(7029);function o(e){if(!e||0===e.trim().length)return e;let t=[];t=e.includes("\n\n")?e.split(/\n\s*\n/):e.includes("\n")?e.split(/\n/):[e];let r=[];for(let e of t){let t=e.trim();if(!t)continue;if(t.length<=150){r.push(t);continue}let a=[],n=t.split(/([.!?]+["']?\s+)/),l="";for(let e=0;e<n.length;e++){let t=n[e];t&&(/[.!?]+["']?\s*$/.test(t)?((l+=t).trim()&&a.push(l.trim()),l=""):l+=t)}if(l.trim()&&a.push(l.trim()),a.length<=1||a.some(e=>e.length>1200)){a=t.split(/([.!?]+["']?\s*)/).filter(e=>e.trim().length>0);let e=[];for(let t=0;t<a.length;t++)/^[.!?]+["']?\s*$/.test(a[t])?e.length>0&&(e[e.length-1]+=a[t]):e.push(a[t]);a=e.filter(e=>e.trim().length>0)}if(a.length<=1&&t.length>600&&(a=t.split(/([.;]\s+)/).filter(e=>e.trim().length>0)),a.length<=1||a.some(e=>e.length>900)){let e=t.split(/\s+/).filter(e=>e.length>0),r=Math.ceil(t.length/600),n=Math.max(30,Math.ceil(e.length/r));a=[];for(let t=0;t<e.length;t+=n){let r=e.slice(t,t+n).join(" ");r.trim()&&a.push(r.trim())}}let c="",o=0;for(let e of a){let t=e.trim();if(!t)continue;let a=t.split(/\s+/).filter(e=>e.length>0).length,n=t.length;c&&(c.length+n+1>600||o+a>100)?(c.trim()&&r.push(c.trim()),c=t,o=a):(c+=(c?" ":"")+t,o+=a)}c.trim()&&r.push(c.trim())}return r.join("\n\n")}var i=r(7576),s=r(1402),u=r.n(s),d=r(7398),m=r.n(d);function h(e){var t,r,n,l;let{article:c}=e,o=[{label:"Views",value:null!==(t=c.viewCount)&&void 0!==t?t:0,icon:"\uD83D\uDC41️"},{label:"Comments",value:null!==(r=c.totalComments)&&void 0!==r?r:0,icon:"\uD83D\uDCAC"},{label:"Reposts",value:null!==(n=c.totalShares)&&void 0!==n?n:0,icon:"\uD83D\uDD01"},{label:"Pats",value:null!==(l=c.totalPats)&&void 0!==l?l:0,icon:"❤️"},{label:"Bookmark",value:null,icon:"\uD83D\uDD16"}];return(0,a.jsx)("div",{className:u().socialActionBar,children:o.map(e=>(0,a.jsxs)("button",{type:"button",className:u().socialActionStat,children:[(0,a.jsx)("span",{className:u().socialActionIcon,children:e.icon}),(0,a.jsxs)("div",{className:u().socialActionLabel,children:[(0,a.jsx)("span",{children:e.label}),null!==e.value&&(0,a.jsx)("strong",{className:u().socialActionCount,children:e.value.toLocaleString()})]})]},e.label))})}function _(e){var t,r;let{article:s}=e,[d,_]=(0,n.useState)(!1),[p,f]=(0,n.useState)([]),[g,A]=(0,n.useState)(!0),[y,x]=(0,n.useState)("idle"),[v,b]=(0,n.useState)(!1),[R,j]=(0,n.useState)({open:!1,action:"view this content"}),[N,k]=(0,n.useState)(s.body),[S,w]=(0,n.useState)(null!==(t=s.summaryType)&&void 0!==t?t:"EXTRACTIVE"),[C,T]=(0,n.useState)(!1),[L,B]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=window.matchMedia("(prefers-color-scheme: dark)");_(e.matches);let t=e=>_(e.matches);return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[]),(0,n.useEffect)(()=>{(async function(){try{A(!0);let e=await (0,c.lk)(s.id);f(e)}catch(e){console.error("Failed to load comments:",e),f([])}finally{A(!1)}})()},[s.id]);let E=(0,n.useMemo)(()=>window.location.href,[s.id]);(0,n.useEffect)(()=>{if("idle"===y)return;let e=setTimeout(()=>x("idle"),2500);return()=>clearTimeout(e)},[y]),(0,n.useEffect)(()=>{let e=!1;return(async()=>{try{let t=await (0,c.r$)();e||b(t.authenticated)}catch(t){e||b(!1)}})(),()=>{e=!0}},[]);let D=e=>{let t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)},I=async()=>{try{var e,t;(null===(t=navigator)||void 0===t?void 0:null===(e=t.clipboard)||void 0===e?void 0:e.writeText)?await navigator.clipboard.writeText(E):D(E),x("copied")}catch(e){try{D(E),x("copied")}catch(e){console.error("Failed to copy article link",e),x("error")}}},M="copied"===y?"Link copied!":"error"===y?"Unable to copy":"Copy pat link",P=function(e){if(e.sourceUrl)try{return new URL(e.sourceUrl).hostname.replace(/^www\./,"")}catch(e){}return e.categoryName||"Patreek"}(s);r=s.createdAt,m()(r).isSame(m()(),"day")||m()(s.createdAt).format("MMM DD"),(0,n.useEffect)(()=>{var e;k(s.body),w(null!==(e=s.summaryType)&&void 0!==e?e:"EXTRACTIVE"),B(null),T(!1)},[s.body,s.summaryType]);let U=(0,n.useMemo)(()=>N&&0!==N.trim().length?/<[a-z][\s\S]*>/i.test(N)?function(e){if(!e||0===e.trim().length)return e;let t=e.match(/<p[^>]*>[\s\S]*?<\/p>/gi);if(t&&!t.some(e=>e.replace(/<[^>]*>/g,"").trim().length>600)&&t.length>2)return e;let r=e.replace(/<\/p>\s*<p[^>]*>/gi,"\n\n");r=(r=(r=r.replace(/<p[^>]*>/gi,"")).replace(/<\/p>/gi,"")).replace(/<\/?(div|section|article)[^>]*>/gi,"");let a={},n=0,l=o(r=r.replace(/<(\/?)([a-z]+)[^>]*>/gi,(e,t,r)=>{let l="__TAG_".concat(n,"__");return a[l]=e,n++,l}));return Object.keys(a).forEach(e=>{l=l.replace(e,a[e])}),l.split(/\n\s*\n/).filter(e=>e.trim()).map(e=>"<p>".concat(e.trim(),"</p>")).join("\n")}(N):o(N):N,[N]),W=!1===s.isPublic,O=async()=>{if(!C){T(!0),B(null);try{var e,t,r;let a=await fetch("".concat(c.CT,"/api/v1/feeds/").concat(s.id,"/enhance"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"});if(!a.ok)throw Error("Unable to summarize with AI right now.");let n=await a.json(),l=null!==(t=null!==(e=n.body)&&void 0!==e?e:n.excerpt)&&void 0!==t?t:N,o=null!==(r=n.summaryType)&&void 0!==r?r:"AI_GENERATED";k(l),w(o)}catch(e){B(e instanceof Error?e.message:"Summarization failed.")}finally{T(!1)}}},V=e=>{j({open:!0,action:e})};return(0,a.jsxs)("div",{className:"".concat(u().container," ").concat(d?u().dark:""),children:[(0,a.jsx)("main",{className:u().main,children:(0,a.jsxs)("article",{className:u().article,children:[s.imageUrl&&(0,a.jsx)("div",{className:u().imageWrapper,children:(0,a.jsx)("img",{src:s.imageUrl,alt:s.title,className:u().image})}),(0,a.jsxs)("p",{className:u().sourceLine,children:["From ",P]}),(0,a.jsx)(h,{article:s}),(0,a.jsx)("h1",{className:u().title,children:s.title}),s.excerpt&&(0,a.jsx)("p",{className:u().description,children:s.excerpt}),W&&!v?(0,a.jsxs)("div",{className:u().authLocked,children:[(0,a.jsx)("h3",{children:"Members only"}),(0,a.jsx)("p",{children:"Sign in to read this story and join the discussion."}),(0,a.jsx)("button",{type:"button",className:"".concat(u().enhanceButton," ").concat(u().authUnlockButton),onClick:()=>V("read this story"),children:"Unlock story"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:u().content,dangerouslySetInnerHTML:{__html:U}}),"EXTRACTIVE"===S&&(0,a.jsxs)("div",{className:u().enhanceWrapper,children:[L&&(0,a.jsx)("p",{className:u().enhanceError,children:L}),(0,a.jsx)("button",{type:"button",className:"".concat(u().enhanceButton," ").concat(C?u().enhanceButtonLoading:""),onClick:O,disabled:C,children:C?"Summarizing…":"✨ Summarize with AI"})]}),(0,a.jsxs)("div",{className:u().commentsSection,children:[(0,a.jsx)("h2",{className:u().commentsTitle,children:"Comments"}),(0,a.jsxs)("div",{className:u().shareBar,children:[(0,a.jsx)("p",{className:u().shareLabel,children:"Share this Pat"}),(0,a.jsxs)("div",{className:u().shareActions,children:[(0,a.jsxs)("button",{type:"button",className:"".concat(u().shareButton," ").concat("copied"===y?u().shareButtonSuccess:""," ").concat("error"===y?u().shareButtonError:""),onClick:I,"aria-live":"polite",title:M,children:[(0,a.jsxs)("svg",{viewBox:"0 0 32 32","aria-hidden":"true",className:u().shareIcon,children:[(0,a.jsx)("path",{d:"M18.586 5.414a5 5 0 0 1 7.071 7.071l-3 3a1 1 0 0 1-1.414-1.414l3-3a3 3 0 1 0-4.243-4.243l-3 3a1 1 0 1 1-1.414-1.414l3-3z",fill:"currentColor"}),(0,a.jsx)("path",{d:"M13.414 26.586a5 5 0 0 1-7.071-7.071l3-3a1 1 0 0 1 1.414 1.414l-3 3a3 3 0 1 0 4.243 4.243l3-3a1 1 0 1 1 1.414 1.414l-3 3z",fill:"currentColor"}),(0,a.jsx)("path",{d:"M20.586 11.586l-8 8a1 1 0 0 1-1.414-1.414l8-8a1 1 0 0 1 1.414 1.414z",fill:"currentColor"})]}),(0,a.jsx)("span",{className:u().shareText,children:M})]}),(0,a.jsx)("button",{type:"button",className:u().replyButton,onClick:()=>{v||V("reply to a comment")},children:"Reply"})]})]}),g?(0,a.jsx)("p",{className:u().commentsLoading,children:"Loading comments..."}):0===p.length?(0,a.jsx)("p",{className:u().noComments,children:"No comments yet."}):(0,a.jsx)("div",{className:u().commentsList,children:p.map((e,t)=>(0,a.jsxs)("div",{className:u().commentItem,children:[(0,a.jsxs)("div",{className:u().commentHeader,children:[e.photoUrl&&(0,a.jsx)("img",{src:e.photoUrl,alt:e.author,className:u().commentAvatar}),(0,a.jsxs)("div",{className:u().commentAuthorInfo,children:[(0,a.jsx)("span",{className:u().commentAuthor,children:e.author}),(0,a.jsx)("span",{className:u().commentDate,children:m()(e.createdAt).format("MMM DD, YYYY")})]})]}),(0,a.jsx)("p",{className:u().commentBody,children:e.body})]},t))})]})]}),(0,a.jsx)("div",{className:"".concat(u().unlockBanner," ").concat(u().mobileOnly),children:(0,a.jsxs)("div",{className:u().unlockBannerContent,children:[(0,a.jsx)("p",{className:u().unlockText,children:"UNLOCK YOUR PATS"}),(0,a.jsxs)("p",{className:u().unlockDescription,children:["Register to get the latest updates from the topics"," ",(0,a.jsx)("span",{className:u().unlockUnderline,children:"you"})," care about"]}),(0,a.jsxs)("div",{className:u().storeButtons,children:[(0,a.jsx)("a",{href:"https://apps.apple.com/us/app/patreek/id6547858283",target:"_blank",rel:"noopener noreferrer",className:u().storeLink,children:(0,a.jsx)(l.default,{src:"https://cdn.prod.website-files.com/675ca775325477a121669e3c/67a3729b558347b9bf210a5a_Store%3DApp%20Store%2C%20Type%3DDark%2C%20Language%3DEnglish%402x.png",alt:"Download on App Store",width:200,height:60,className:u().storeImage})}),(0,a.jsx)("a",{href:"#",className:u().storeLink,children:(0,a.jsx)(l.default,{src:"https://cdn.prod.website-files.com/675ca775325477a121669e3c/67a3727c8abb3515ab42d712_Store%3DGoogle%20Play%2C%20Type%3DDark%2C%20Language%3DEnglish%402x.png",alt:"Get it on Google Play",width:200,height:60,className:u().storeImage})})]})]})})]})}),(0,a.jsx)(i.Z,{isOpen:R.open,triggerAction:R.action,onClose:()=>{j(e=>({...e,open:!1}))}})]})}},7576:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var a=r(7437),n=r(9376),l=r(7011),c=r.n(l);function o(e){let{isOpen:t,triggerAction:r,onClose:l,onRegister:o,disableClose:i=!1}=e,s=(0,n.useRouter)();if(!t)return null;let u=()=>{s.push("/registration"),null==l||l()};return(0,a.jsx)("div",{className:c().backdrop,role:"dialog","aria-modal":"true",children:(0,a.jsxs)("div",{className:c().modal,children:[(0,a.jsxs)("div",{className:c().header,children:[(0,a.jsx)("p",{className:c().eyebrow,children:"Members only"}),(0,a.jsxs)("h3",{children:["Unlock this ",r]}),!i&&l&&(0,a.jsx)("button",{type:"button",className:c().close,onClick:l,"aria-label":"Close modal",children:"\xd7"})]}),(0,a.jsx)("p",{className:c().copy,children:"Signing in gives you access to full articles, leaderboard chats, and private categories."}),(0,a.jsxs)("div",{className:c().actions,children:[(0,a.jsx)("button",{type:"button",className:c().primary,onClick:u,children:"Sign In"}),(0,a.jsx)("button",{type:"button",className:c().secondary,onClick:null!=o?o:u,children:"Register"}),(0,a.jsx)("button",{type:"button",className:c().link,onClick:()=>{s.push("/"),null==l||l()},children:"Go home"})]})]})})}},4422:function(e,t,r){"use strict";r.d(t,{A:function(){return n},t:function(){return l}});let a="patreek_article_";function n(e){try{let t="".concat(a).concat(e),r=localStorage.getItem(t);if(!r)return null;let n=JSON.parse(r);if(Date.now()-n.timestamp>6048e5)return localStorage.removeItem(t),null;return n.data}catch(e){return console.error("Error reading from cache:",e),null}}function l(e,t){let r="".concat(a).concat(e),n={data:t,timestamp:Date.now()};try{localStorage.setItem(r,JSON.stringify(n))}catch(e){if(console.error("Error writing to cache:",e),e instanceof DOMException&&"QuotaExceededError"===e.name){c();try{localStorage.setItem(r,JSON.stringify(n))}catch(e){console.error("Failed to cache after cleanup:",e)}}}}function c(){try{let e=Date.now(),t=[];for(let r=0;r<localStorage.length;r++){let n=localStorage.key(r);if(null==n?void 0:n.startsWith(a))try{let r=localStorage.getItem(n);if(r){let a=JSON.parse(r);e-a.timestamp>6048e5&&t.push(n)}}catch(e){t.push(n)}}t.forEach(e=>localStorage.removeItem(e))}catch(e){console.error("Error clearing expired cache:",e)}}c()},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},257:function(e,t,r){"use strict";var a,n;e.exports=(null==(a=r.g.process)?void 0:a.env)&&"object"==typeof(null==(n=r.g.process)?void 0:n.env)?r.g.process:r(4227)},4227:function(e){!function(){var t={229:function(e){var t,r,a,n=e.exports={};function l(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===l||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:l}catch(e){t=l}try{r="function"==typeof clearTimeout?clearTimeout:c}catch(e){r=c}}();var i=[],s=!1,u=-1;function d(){s&&a&&(s=!1,a.length?i=a.concat(i):u=-1,i.length&&m())}function m(){if(!s){var e=o(d);s=!0;for(var t=i.length;t;){for(a=i,i=[];++u<t;)a&&a[u].run();u=-1,t=i.length}a=null,s=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===c||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function _(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];i.push(new h(e,t)),1!==i.length||s||o(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=_,n.addListener=_,n.once=_,n.off=_,n.removeListener=_,n.removeAllListeners=_,n.emit=_,n.prependListener=_,n.prependOnceListener=_,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},r={};function a(e){var n=r[e];if(void 0!==n)return n.exports;var l=r[e]={exports:{}},c=!0;try{t[e](l,l.exports,a),c=!1}finally{c&&delete r[e]}return l.exports}a.ab="//";var n=a(229);e.exports=n}()},1402:function(e){e.exports={container:"ArticleReader_container__jO2L5",dark:"ArticleReader_dark__PbS6A",header:"ArticleReader_header__dbPzK",headerInner:"ArticleReader_headerInner__yrlm4",logoLink:"ArticleReader_logoLink__Kc5xR",logo:"ArticleReader_logo__Ffm7W",headerCenter:"ArticleReader_headerCenter__ju69k",categoryName:"ArticleReader_categoryName__DrJk6",date:"ArticleReader_date__7kari",main:"ArticleReader_main__vwq7A",article:"ArticleReader_article__XHm3G",imageWrapper:"ArticleReader_imageWrapper__NI6E9",image:"ArticleReader_image__pYNG4",title:"ArticleReader_title__0ba_F",description:"ArticleReader_description__FGiUV",sourceLine:"ArticleReader_sourceLine__RZAZH",socialActionBar:"ArticleReader_socialActionBar__4FMxY",socialActionStat:"ArticleReader_socialActionStat__9OAmS",socialActionIcon:"ArticleReader_socialActionIcon__oJXys",socialActionLabel:"ArticleReader_socialActionLabel__6iiHe",socialActionCount:"ArticleReader_socialActionCount__Fbhw_",socialBar:"ArticleReader_socialBar__BN1fw",socialStat:"ArticleReader_socialStat__UWiA5",socialIcon:"ArticleReader_socialIcon__wtyxj",socialValue:"ArticleReader_socialValue__1ZoyS",socialLabel:"ArticleReader_socialLabel__OJ_78",content:"ArticleReader_content__KVC5g",authLocked:"ArticleReader_authLocked__M9s_W",authUnlockButton:"ArticleReader_authUnlockButton__VLBsk",replyButton:"ArticleReader_replyButton__PVHgJ",enhanceWrapper:"ArticleReader_enhanceWrapper__yBiSn",enhanceButton:"ArticleReader_enhanceButton__6VGEX",enhanceButtonLoading:"ArticleReader_enhanceButtonLoading__d2AdE",shimmer:"ArticleReader_shimmer__9Lz7E",enhanceError:"ArticleReader_enhanceError__ud1KI",unlockBanner:"ArticleReader_unlockBanner__4dPP0",unlockBannerContent:"ArticleReader_unlockBannerContent__xQm1Q",unlockText:"ArticleReader_unlockText__XI_xN",unlockDescription:"ArticleReader_unlockDescription__D8kgb",unlockUnderline:"ArticleReader_unlockUnderline__MRWY0",storeButtons:"ArticleReader_storeButtons__KTAzN",storeLink:"ArticleReader_storeLink__8tyrD",mobileOnly:"ArticleReader_mobileOnly__Nllwg",storeImage:"ArticleReader_storeImage__DCJpi",shareBar:"ArticleReader_shareBar__wqAA0",shareLabel:"ArticleReader_shareLabel__PHJAa",shareActions:"ArticleReader_shareActions__PfXtu",shareButton:"ArticleReader_shareButton__5ySjX",shareButtonSuccess:"ArticleReader_shareButtonSuccess__87EY7",shareButtonError:"ArticleReader_shareButtonError__Zsnhj",shareIcon:"ArticleReader_shareIcon__7cF3c",shareText:"ArticleReader_shareText__1pe4m",commentsSection:"ArticleReader_commentsSection__rqZOR",commentsTitle:"ArticleReader_commentsTitle__xw6PS",commentsLoading:"ArticleReader_commentsLoading__nu_pR",noComments:"ArticleReader_noComments__eVpLR",commentsList:"ArticleReader_commentsList__I_eEj",commentItem:"ArticleReader_commentItem__h_m06",commentHeader:"ArticleReader_commentHeader__bKesh",commentAvatar:"ArticleReader_commentAvatar___Zlwi",commentAuthorInfo:"ArticleReader_commentAuthorInfo__GWLyj",commentAuthor:"ArticleReader_commentAuthor__CQ3yY",commentDate:"ArticleReader_commentDate__eV3mx",commentBody:"ArticleReader_commentBody__SaDKq"}},7011:function(e){e.exports={backdrop:"AuthWallModal_backdrop__GPqpR",modal:"AuthWallModal_modal__fYr6S",header:"AuthWallModal_header__aq9BM",eyebrow:"AuthWallModal_eyebrow__U8I7N",close:"AuthWallModal_close__VjpfS",copy:"AuthWallModal_copy___qp9V",actions:"AuthWallModal_actions__HzRdw",primary:"AuthWallModal_primary__ZefXv",secondary:"AuthWallModal_secondary__ra701",link:"AuthWallModal_link__ggpfm"}}}]);