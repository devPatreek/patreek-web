"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7029],{7029:function(e,t,n){n.d(t,{CT:function(){return c},ng:function(){return E},By:function(){return v},r$:function(){return w},EJ:function(){return y},sv:function(){return _},A9:function(){return G},jV:function(){return J},I3:function(){return j},VN:function(){return S},A5:function(){return C},Fd:function(){return k},tG:function(){return f},lk:function(){return p},U$:function(){return A},TH:function(){return b},PK:function(){return T},lL:function(){return h},ST:function(){return d},Dk:function(){return s},getUserProfile:function(){return u},Zm:function(){return l},pH:function(){return g},aK:function(){return z},Og:function(){return P},a$:function(){return m},w7:function(){return V},qB:function(){return O},eH:function(){return R},CC:function(){return x},VG:function(){return L},vr:function(){return U},EW:function(){return F},D7:function(){return N},ck:function(){return B},sS:function(){return I}});let a="patreek_session";function o(e){try{window.localStorage.setItem(a,e)}catch(e){console.warn("[Session] Failed to write to localStorage:",e)}}function r(){try{window.localStorage.removeItem(a)}catch(e){console.warn("[Session] Failed to remove from localStorage:",e)}}function i(){let e=function(){try{return window.localStorage.getItem(a)}catch(e){return console.warn("[Session] Failed to read from localStorage:",e),null}}();return e?{"X-Session-Token":e}:{}}let c=(n(257).env.INTERNAL_API_URL,"http://localhost:5555/api/v1");async function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let t=new AbortController,n=setTimeout(()=>t.abort(),1e4),a=new URLSearchParams({page:"0",size:"30"});e.query&&e.query.trim().length>0&&a.set("query",e.query.trim()),"number"==typeof e.categoryId&&a.set("categoryId",e.categoryId.toString());let o=new URLSearchParams(window.location.search),r=null==o?void 0:o.get("bypass");"ag3nt007"===r&&a.set("bypass","ag3nt007");let i="".concat(c,"/api/v1/feeds/public?").concat(a.toString()),s=await fetch(i,{method:"GET",cache:"default",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:t.signal});if(clearTimeout(n),!s.ok)return console.warn("[API] Failed to fetch public feeds: ".concat(s.status)),[];return((await s.json()).content||[]).slice(0,30)}catch(e){return e instanceof Error?"AbortError"===e.name||e.message.includes("timeout")||e.message.includes("TIMED_OUT")?console.warn("[API] Connection timeout while fetching public feeds - backend may be unavailable"):e.message.includes("Failed to fetch")||e.message.includes("ERR_CONNECTION")?console.warn("[API] Connection error while fetching public feeds - backend may be unavailable"):console.warn("[API] Error fetching public feeds:",e.message):console.warn("[API] Unknown error fetching public feeds:",e),[]}}async function l(e){try{let t=new AbortController,n=setTimeout(()=>t.abort(),1e4),a=await fetch("".concat(c,"/api/v1/user/profile/username/").concat(encodeURIComponent(e)),{method:"GET",headers:{Accept:"application/json"},credentials:"include",signal:t.signal});if(clearTimeout(n),!a.ok){if(404===a.status)return null;return console.warn("[API] Failed to fetch user profile by username:",a.status),null}let o=await a.json(),r=o.data||o||null;return M(r,e)}catch(e){return console.warn("[API] Error fetching user profile by username",e),null}}async function u(e){try{let t=new AbortController,n=setTimeout(()=>t.abort(),1e4),a={Accept:"application/json"};e?Object.assign(a,{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(e)}):Object.assign(a,i());let o=await fetch("".concat(c,"/api/v1/user/profile"),{method:"GET",headers:a,credentials:"include",signal:t.signal});if(clearTimeout(n),!o.ok)return console.warn("[API] Failed to fetch user profile:",o.status),null;let r=await o.json(),s=r.data||r||null;return M(s)}catch(e){return console.warn("[API] Error fetching user profile",e),null}}async function d(e){try{let t=new AbortController,n=setTimeout(()=>t.abort(),1e4),a=new URLSearchParams(window.location.search),o=null==a?void 0:a.get("bypass"),r="".concat(c,"/api/v1/feeds/").concat(e).concat("ag3nt007"===o?"?bypass=ag3nt007":"");console.log("[API] Fetching article ".concat(e," from: ").concat(r));let i=await fetch(r,{method:"GET",cache:"default",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"omit",mode:"cors",signal:t.signal});if(clearTimeout(n),!i.ok){let t=/^((?!chrome|android).)*safari/i.test(window.navigator.userAgent);if(404===i.status||403===i.status)return t&&console.error("[API] Safari: Article ".concat(e," returned ").concat(i.status,". Check if this is a CORS issue or if article is actually not found.")),console.warn("[API] Article ".concat(e," not found or not available (").concat(i.status,")")),null;return t&&console.error("[API] Safari: Failed to fetch feed ".concat(e,": ").concat(i.status,". Response headers:"),Object.fromEntries(i.headers.entries())),console.warn("[API] Failed to fetch feed ".concat(e,": ").concat(i.status)),null}let s=i.headers.get("content-type");s&&s.includes("application/json")||console.warn("[API] Unexpected content type: ".concat(s,". Expected application/json"));let l=await i.json();return console.log("[API] Successfully fetched article ".concat(e,":"),l.title),l}catch(t){if(t instanceof Error){let n=/^((?!chrome|android).)*safari/i.test(window.navigator.userAgent);"AbortError"===t.name||t.message.includes("timeout")||t.message.includes("TIMED_OUT")?console.warn("[API] Connection timeout while fetching article ".concat(e," - backend may be unavailable")):t.message.includes("Failed to fetch")||t.message.includes("ERR_CONNECTION")||t.message.includes("NetworkError")?n?console.error("[API] Safari CORS/Network error while fetching article ".concat(e,". This might be a CORS configuration issue. Error:"),t.message):console.warn("[API] Connection error while fetching article ".concat(e," - backend may be unavailable")):t.message.includes("CORS")||t.message.includes("cross-origin")?console.error("[API] CORS error while fetching article ".concat(e,". Check backend CORS configuration. Error:"),t.message):console.warn("[API] Error fetching feed ".concat(e,":"),t.message)}else console.warn("[API] Unknown error fetching feed ".concat(e,":"),t);return null}}async function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;try{let a=new AbortController,o=setTimeout(()=>a.abort(),1e4),r=await fetch("".concat(c,"/api/v1/feeds/").concat(e,"/comments?page=").concat(t,"&size=").concat(n),{method:"GET",cache:"default",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:a.signal});if(clearTimeout(o),!r.ok)return console.warn("[API] Failed to fetch comments for feed ".concat(e,": ").concat(r.status)),[];return(await r.json()).content||[]}catch(t){return t instanceof Error?"AbortError"===t.name||t.message.includes("timeout")?console.warn("[API] Connection timeout while fetching comments for feed ".concat(e)):console.warn("[API] Error fetching comments for feed ".concat(e,":"),t.message):console.warn("[API] Unknown error fetching comments for feed ".concat(e,":"),t),[]}}async function f(){try{console.log("[API] Fetching all categories from:","".concat(c,"/api/v1/categories"));let e=new AbortController,t=setTimeout(()=>e.abort(),1e4),n=await fetch("".concat(c,"/api/v1/categories"),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:e.signal});if(clearTimeout(t),console.log("[API] All categories response status:",n.status),!n.ok){console.warn("[API] Failed to fetch all categories:",n.status,n.statusText);let e=await n.text();return console.warn("[API] Error response body:",e),[]}let a=await n.json();if(console.log("[API] All categories data received:",a),Array.isArray(a))return console.log("[API] Returning",a.length,"top-level categories"),a;if(Array.isArray(null==a?void 0:a.content))return console.log("[API] Returning",a.content.length,"categories from content"),a.content;if(Array.isArray(null==a?void 0:a.categories))return console.log("[API] Returning",a.categories.length,"categories from categories"),a.categories;return console.warn("[API] Unexpected data format:",a),[]}catch(e){return e instanceof Error&&"AbortError"===e.name?console.warn("[API] All categories request timed out"):console.error("[API] Error fetching all categories",e),[]}}async function h(){try{console.log("[API] Fetching public categories from:","".concat(c,"/api/v1/categories/public"));let e=new AbortController,t=setTimeout(()=>e.abort(),1e4),n=await fetch("".concat(c,"/api/v1/categories/public"),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:e.signal});if(clearTimeout(t),console.log("[API] Public categories response status:",n.status),!n.ok){console.warn("[API] Failed to fetch public categories:",n.status,n.statusText);let e=await n.text();return console.warn("[API] Error response body:",e),[]}let a=await n.json();if(console.log("[API] Public categories data received:",a),Array.isArray(a))return console.log("[API] Returning",a.length,"categories"),a;if(Array.isArray(null==a?void 0:a.content))return console.log("[API] Returning",a.content.length,"categories from content"),a.content;if(Array.isArray(null==a?void 0:a.categories))return console.log("[API] Returning",a.categories.length,"categories from categories"),a.categories;return console.warn("[API] Unexpected data format:",a),[]}catch(e){return e instanceof Error&&"AbortError"===e.name?console.warn("[API] Public categories request timed out"):console.error("[API] Error fetching public categories",e),[]}}async function m(e){let t=new AbortController,n=setTimeout(()=>t.abort(),15e3);try{var a;let r=await fetch("".concat(c,"/api/v1/auth/signup"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(e),signal:t.signal});if(clearTimeout(n),!r.ok){let e=await r.text();throw Error(e||"Unable to sign up right now")}let i=await r.json();return i.token?o(i.token):(null===(a=i.data)||void 0===a?void 0:a.token)&&o(i.data.token),i}catch(e){if(clearTimeout(n),e instanceof Error&&"AbortError"===e.name)throw Error("Signup timed out, please try again");throw e instanceof Error?e:Error("Unknown signup error")}}async function g(e){let t=new AbortController,n=setTimeout(()=>t.abort(),15e3);try{var a;let r=await fetch("".concat(c,"/api/v1/auth/signin"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(e),signal:t.signal});if(clearTimeout(n),!r.ok){let e=await r.text();throw Error(e||"Unable to sign in right now")}let i=await r.json();return i.token?o(i.token):(null===(a=i.data)||void 0===a?void 0:a.token)&&o(i.data.token),i}catch(e){if(clearTimeout(n),e instanceof Error&&"AbortError"===e.name)throw Error("Sign in timed out, please try again");throw e instanceof Error?e:Error("Unknown sign in error")}}async function w(){try{let e=new AbortController,t=setTimeout(()=>e.abort(),5e3),n=i(),a=await fetch("".concat(c,"/api/v1/user/auth-status"),{method:"GET",headers:{Accept:"application/json",...n},credentials:"include",signal:e.signal});if(clearTimeout(t),!a.ok)return{authenticated:!1};let o=await a.json();return{authenticated:!0===o.authenticated,userId:o.userId,username:o.username,email:o.email,message:o.authenticated?"Authenticated":"Not authenticated"}}catch(e){return console.warn("[API] Error checking session status:",e),{authenticated:!1}}}async function y(e){let t=new AbortController,n=setTimeout(()=>t.abort(),1e4);try{var a,o,r;let i=await fetch("".concat(c,"/api/v1/user/username/").concat(encodeURIComponent(e)),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:t.signal});if(clearTimeout(n),i.ok){let e=await i.json();return{available:!0,message:(null==e?void 0:null===(a=e.data)||void 0===a?void 0:a.message)||"Username is available"}}let s="Username is not available";try{let e=await i.json();s=(null==e?void 0:null===(o=e.error)||void 0===o?void 0:o.message)||(null==e?void 0:e.message)||(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.message)||s}catch(e){try{s=await i.text()||s}catch(e){}}if(403===i.status)return{available:!1,message:s};return i.status,{available:!1,message:s}}catch(e){throw clearTimeout(n),e instanceof Error?e:Error("Unable to check username")}}async function v(e){let t=new AbortController,n=setTimeout(()=>t.abort(),1e4);try{var a,o,r;let i=await fetch("".concat(c,"/api/v1/user/email/").concat(encodeURIComponent(e)),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:t.signal});if(clearTimeout(n),i.ok){let e=await i.json();return{available:!0,message:(null==e?void 0:null===(a=e.data)||void 0===a?void 0:a.message)||"Email is available"}}let s="Email is not available";try{let e=await i.json();s=(null==e?void 0:null===(o=e.error)||void 0===o?void 0:o.message)||(null==e?void 0:e.message)||(null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.message)||s}catch(e){try{s=await i.text()||s}catch(e){}}if(403===i.status)return{available:!1,message:s||"Email is already registered"};if(400===i.status)return{available:!1,message:s||"Invalid email format"};return{available:!1,message:s}}catch(e){throw clearTimeout(n),e instanceof Error?e:Error("Unable to check email")}}async function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=new AbortController,a=setTimeout(()=>n.abort(),8e3);try{let o=await fetch("".concat(c,"/api/v1/community/leaderboard?metric=").concat(e,"&limit=").concat(t),{method:"GET",headers:{Accept:"application/json"},cache:"no-store",signal:n.signal});if(clearTimeout(a),!o.ok)return console.warn("[API] leaderboard request failed",o.status),H(e);let r=await o.json();return((null==r?void 0:r.data)||(null==r?void 0:r.content)||r||[]).map((e,t)=>{var n,a,o;let r="number"==typeof e.rank?e.rank:"number"==typeof(null===(n=e.rank)||void 0===n?void 0:n.level)?e.rank.level:t+1;return{username:e.username||e.name||"user-".concat(t+1),displayName:e.displayName||e.name,avatarUrl:e.avatarUrl,total:null!==(o=null!==(a=e.total)&&void 0!==a?a:e.score)&&void 0!==o?o:0,rank:r}})}catch(t){return clearTimeout(a),console.warn("[API] leaderboard error",t),H(e)}}async function b(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=new AbortController,n=setTimeout(()=>t.abort(),8e3);try{let a=await fetch("".concat(c,"/api/v1/notifications?limit=").concat(e),{method:"GET",headers:{Accept:"application/json",...i()},credentials:"include",cache:"no-store",signal:t.signal});if(clearTimeout(n),!a.ok)return console.warn("[API] notifications request failed",a.status),q();let o=await a.json();return((null==o?void 0:o.data)||(null==o?void 0:o.content)||o||[]).map((e,t)=>{var n,a,o,r,i;return{id:String(null!==(n=e.id)&&void 0!==n?n:"notif-".concat(t)),type:null!==(a=e.type)&&void 0!==a?a:"system",title:null!==(o=e.title)&&void 0!==o?o:"Notification",message:null!==(r=e.message)&&void 0!==r?r:"",actorUsername:e.actorUsername,resourceType:e.resourceType,resourceId:e.resourceId,isRead:!!e.isRead,createdAt:null!==(i=e.createdAt)&&void 0!==i?i:new Date().toISOString()}})}catch(e){return clearTimeout(n),console.warn("[API] notifications error",e),q()}}async function T(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2?arguments[2]:void 0,a=new URLSearchParams({page:e.toString(),size:t.toString()});n&&a.append("categoryId",n.toString());let o=await fetch("".concat(c,"/api/v1/opinions?").concat(a),{method:"GET",headers:{Accept:"application/json"},credentials:"omit"});if(!o.ok)throw Error("Failed to fetch opinions: ".concat(o.statusText));return(await o.json()).data}async function E(){try{var e;let t=new AbortController,n=setTimeout(()=>t.abort(),3e3),a=await fetch("".concat(c,"/api/v1/admin/session"),{method:"GET",headers:{Accept:"application/json"},credentials:"include",signal:t.signal});if(clearTimeout(n),!a.ok)return console.warn("[Admin] Session check failed:",a.status,a.statusText),!1;let o=await a.json(),r=(null===(e=o.data)||void 0===e?void 0:e.authenticated)===!0;return console.log("[Admin] Session check result:",r),r}catch(e){return"AbortError"===e.name?console.warn("[Admin] Session check timed out"):console.warn("[Admin] Session check error:",e.message||e),!1}}async function j(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2?arguments[2]:void 0,a=new URLSearchParams({page:e.toString(),size:t.toString()});n&&a.append("status",n);let o=await fetch("".concat(c,"/api/v1/admin/support-messages?").concat(a),{method:"GET",headers:{Accept:"application/json"},credentials:"include"});if(!o.ok)throw Error("Failed to fetch support messages");return(await o.json()).data||{content:[],totalElements:0,totalPages:0,number:0,size:20}}async function P(e){if(!(await fetch("".concat(c,"/api/v1/admin/support-messages/").concat(e,"/read"),{method:"PATCH",headers:{Accept:"application/json"},credentials:"include"})).ok)throw Error("Failed to mark message as read")}async function I(e,t){if(!(await fetch("".concat(c,"/api/v1/admin/support-messages/").concat(e,"/status"),{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({status:t})})).ok)throw Error("Failed to update message status")}async function k(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2?arguments[2]:void 0,a=new URLSearchParams({page:e.toString(),size:t.toString()});n&&a.append("search",n);let o=await fetch("".concat(c,"/api/v1/admin/users?").concat(a),{method:"GET",headers:{Accept:"application/json"},credentials:"include"});if(!o.ok)throw Error("Failed to fetch users");return(await o.json()).data||{content:[],totalElements:0,totalPages:0,number:0,size:20}}async function S(e){let t=await fetch("".concat(c,"/api/v1/admin/users/email/").concat(encodeURIComponent(e)),{method:"GET",headers:{Accept:"application/json"},credentials:"include"});if(!t.ok){var n;let e=await t.json();throw Error((null==e?void 0:e.message)||(null==e?void 0:null===(n=e.error)||void 0===n?void 0:n.message)||"Failed to fetch user by email")}return(await t.json()).data}async function C(e){let t=await fetch("".concat(c,"/api/v1/admin/users/username/").concat(encodeURIComponent(e)),{method:"GET",headers:{Accept:"application/json"},credentials:"include"});if(!t.ok){var n;let e=await t.json();throw Error((null==e?void 0:e.message)||(null==e?void 0:null===(n=e.error)||void 0===n?void 0:n.message)||"Failed to fetch user by username")}return(await t.json()).data}async function U(e,t){let n=await fetch("".concat(c,"/api/v1/admin/users/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(t)});if(!n.ok)throw Error((await n.json()).message||"Failed to update user");return(await n.json()).data}async function O(e,t){let n=await fetch("".concat(c,"/api/v1/admin/users/").concat(e,"/suspend"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({reason:t})});if(!n.ok)throw Error((await n.json()).message||"Failed to suspend user");return(await n.json()).data}async function R(e){let t=await fetch("".concat(c,"/api/v1/admin/users/").concat(e,"/unsuspend"),{method:"POST",headers:{Accept:"application/json"},credentials:"include"});if(!t.ok)throw Error((await t.json()).message||"Failed to unsuspend user");return(await t.json()).data}async function F(e,t){let n=await fetch("".concat(c,"/api/v1/admin/users/").concat(e,"/coins"),{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({coins:t})});if(!n.ok)throw Error((await n.json()).message||"Failed to update user coins");return(await n.json()).data}async function N(e,t){let n=await fetch("".concat(c,"/api/v1/admin/users/").concat(e,"/rank"),{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({level:t})});if(!n.ok)throw Error((await n.json()).message||"Failed to update user rank");return(await n.json()).data}async function G(){let e=await fetch("".concat(c,"/api/v1/admin/categories"),{method:"GET",headers:{Accept:"application/json"},credentials:"include"});if(!e.ok)throw Error("Failed to fetch categories");return(await e.json()).data||[]}async function x(e,t){let n=await fetch("".concat(c,"/api/v1/admin/categories/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(t)});if(!n.ok){var a;let e=await n.json();throw Error((null==e?void 0:e.message)||(null==e?void 0:null===(a=e.error)||void 0===a?void 0:a.message)||"Failed to update category")}return(await n.json()).data}async function J(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2?arguments[2]:void 0,a=new URLSearchParams({page:e.toString(),size:t.toString()});n&&a.append("search",n);let o=await fetch("".concat(c,"/api/v1/admin/feeds?").concat(a),{method:"GET",headers:{Accept:"application/json"},credentials:"include"});if(!o.ok)throw Error("Failed to fetch feeds");return(await o.json()).data||{content:[],totalElements:0,totalPages:0,number:0,size:20}}async function L(e,t){let n=await fetch("".concat(c,"/api/v1/admin/feeds/").concat(e,"/published"),{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({published:t})});if(!n.ok)throw Error((await n.json()).message||"Failed to update feed published status");return(await n.json()).data}async function _(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=arguments.length>2?arguments[2]:void 0,a=new URLSearchParams({page:e.toString(),size:t.toString()});n&&a.append("actionType",n);let o=await fetch("".concat(c,"/api/v1/admin/activity-logs?").concat(a),{method:"GET",headers:{Accept:"application/json"},credentials:"include"});if(!o.ok)throw Error("Failed to fetch activity logs");return(await o.json()).data||{content:[],totalElements:0,totalPages:0,number:0,size:50}}async function z(e){let t=new AbortController,n=setTimeout(()=>t.abort(),8e3);try{await fetch("".concat(c,"/api/v1/notifications/read"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",...i()},credentials:"include",cache:"no-store",signal:t.signal,body:JSON.stringify({ids:e&&e.length?e:void 0,all:!e||!e.length})})}catch(e){console.warn("[API] mark notifications read error",e)}finally{clearTimeout(n)}}function H(e){return["Ava","Liam","Noah","Mia","Ethan","Zara","Leo","Sofia","Mateo","Isla"].map((t,n)=>({username:"".concat(t.toLowerCase()).concat(n+1),displayName:t,total:1200-47*n+("pats"===e?30:0),rank:n+1}))}function q(){let e=Date.now();return[{id:"n1",type:"tip_received",title:"You received a tip",message:"@jules sent you 2.5 Pat Coins",actorUsername:"jules",isRead:!1,createdAt:new Date(e-3e5).toISOString()},{id:"n2",type:"comment_reply",title:"New reply on your post",message:"@sam replied to your comment",actorUsername:"sam",isRead:!0,createdAt:new Date(e-27e5).toISOString()}]}let D=e=>e?"".concat("pat_avatar_").concat(e.toLowerCase()):"";function M(e,t){if(!e)return e;let n=e.username||t,a=function(e){if(!e)return null;try{let t=localStorage.getItem(D(e));if(!t)return null;let n=JSON.parse(t);if(!(null==n?void 0:n.url)||!(null==n?void 0:n.expiresAt)||Date.now()>n.expiresAt)return localStorage.removeItem(D(e)),null;return n.url}catch(e){return null}}(n);return a&&!e.avatarUrl?e.avatarUrl=a:e.avatarUrl&&n&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:432e5;if(e&&t)try{let a={url:t,expiresAt:Date.now()+n};localStorage.setItem(D(e),JSON.stringify(a)),document.cookie="".concat(D(e),"=").concat(encodeURIComponent(t),"; max-age=").concat(Math.floor(n/1e3),"; path=/")}catch(e){}}(n,e.avatarUrl),e}async function B(e){try{let t=new AbortController,n=setTimeout(()=>t.abort(),1e4),a=i(),o=await fetch("".concat(c,"/api/v1/user/profile"),{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json",...a},credentials:"include",body:JSON.stringify(e),signal:t.signal});if(clearTimeout(n),!o.ok){let e=await o.text(),t="Failed to update profile";try{let n=JSON.parse(e);t=n.message||n.error||t}catch(n){t=e||t}throw Error(t)}let r=await o.json();return r.data||r}catch(e){if(e instanceof Error&&"AbortError"===e.name)throw Error("Update timed out, please try again");throw e instanceof Error?e:Error("Unknown error updating profile")}}async function V(){try{let e=new AbortController,t=setTimeout(()=>e.abort(),5e3),n=i(),a=await fetch("".concat(c,"/api/v1/auth/signout"),{method:"POST",headers:{Accept:"application/json",...n},credentials:"include",signal:e.signal});clearTimeout(t),r(),a.ok||console.warn("[API] Sign-out request failed:",a.status)}catch(e){r(),console.warn("[API] Error during sign-out:",e)}}}}]);