(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3595],{3595:function(e,a,t){"use strict";t.d(a,{Z:function(){return p}});var n=t(7437),i=t(2265),o=t(7648),s=t(3145),r=t(9376),l=t(6914),c=t.n(l),d=t(7029);function u(e){let{className:a}=e;return(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:a,"aria-hidden":"true",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})})}function h(e){let{className:a}=e;return(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:a,"aria-hidden":"true",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 18c2.5-1 5-2 8-2s5.5 1 8 2M3 18v-3c0-1.5 1-3 3-3s3 1.5 3 3v3M3 18h18M9 15v3m6-3v3"}),(0,n.jsx)("circle",{cx:"9",cy:"16",r:"1",fill:"currentColor"}),(0,n.jsx)("circle",{cx:"15",cy:"16",r:"1",fill:"currentColor"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 15c0-1 1-2 2-2s2 1 2 2m4 0c0-1 1-2 2-2s2 1 2 2",opacity:"0.5"})]})}function p(e){let{active:a,hasSession:t=!1}=e,l=(0,r.useRouter)(),p=(0,r.usePathname)(),m=null!=a?a:function(e){if(e){if(e.startsWith("/coins"))return"coins";if(e.startsWith("/media"))return"media";if(e.startsWith("/community"))return"community";if(e.startsWith("/opinion"))return"opinion";if(e.startsWith("/registration")||e.startsWith("/forgot-password"))return"auth";if("/"===e||e.startsWith("/u/"))return"home"}}(p),[g,x]=(0,i.useState)(null),[k,M]=(0,i.useState)(0),[j,H]=(0,i.useState)(!1),[b,v]=(0,i.useState)(!1),[N,y]=(0,i.useState)([]);(0,i.useEffect)(()=>{t&&(async()=>{try{if((await (0,d.checkSessionStatus)()).authenticated){let e=await (0,d.getUserProfile)();(null==e?void 0:e.username)&&x(e.username)}}catch(e){console.warn("Failed to fetch username for profile navigation:",e)}})()},[t]),(0,i.useEffect)(()=>{let e;if(!t)return;let a=!0,n=async()=>{try{let e=await (0,d.tn)();a&&M(e)}catch(e){console.warn("Failed to fetch unread count:",e)}};return n(),e=setInterval(n,6e4),()=>{a=!1,clearInterval(e)}},[t]);let w=async()=>{if(t){v(!0);try{let e=await (0,d.TH)(15);y(e);let a=e.filter(e=>!e.isRead).length;M(a)}catch(e){console.warn("Failed to fetch notifications:",e)}finally{v(!1)}}},B=async()=>{try{await (0,d.aK)(),y(e=>e.map(e=>({...e,isRead:!0}))),M(0)}catch(e){console.warn("Failed to mark notifications read:",e)}},A=[{key:"home",label:"Home",onClick:()=>{t&&g?l.push("/u/".concat(g)):l.push("/")}},{key:"coins",label:"Coins",onClick:()=>l.push("/coins")},{key:"shop",label:"Shop",onClick:()=>window.open("https://shop.patreek.com","_blank")},{key:"media",label:"Media",onClick:()=>l.push("/media")},{key:"community",label:"Community",onClick:()=>l.push("/community")},{key:"opinion",label:"Opinion",onClick:()=>l.push("/opinion")}];return(0,n.jsxs)("header",{className:c().topBar,children:[(0,n.jsx)("div",{className:c().topLeft,children:(0,n.jsx)(o.default,{href:"/",className:c().logoLink,"aria-label":"Patreek home",children:(0,n.jsx)(s.default,{src:"https://cdn.prod.website-files.com/675ca775325477a121669e3c/675caa3a2f73ad268a86b51a_Patreek%20logo_slogan.png",alt:"Patreek",width:110,height:40,className:c().logo,priority:!0})})}),!t&&(0,n.jsx)("div",{className:c().topCenter,children:(0,n.jsxs)("div",{className:c().getApp,children:[(0,n.jsx)("span",{className:c().getAppText,children:"Get the App"}),(0,n.jsx)("a",{href:"https://apps.apple.com/us/app/patreek/id6547858283",target:"_blank",rel:"noopener noreferrer",className:c().storeIcon,"aria-label":"Download on the App Store",children:(0,n.jsx)(s.default,{src:"https://cdn.prod.website-files.com/675ca775325477a121669e3c/67a3729b558347b9bf210a5a_Store%3DApp%20Store%2C%20Type%3DDark%2C%20Language%3DEnglish%402x.png",alt:"App Store",width:90,height:28})}),(0,n.jsx)("a",{href:"",className:c().storeIcon,"aria-label":"Get it on Google Play (coming soon)",children:(0,n.jsx)(s.default,{src:"https://cdn.prod.website-files.com/675ca775325477a121669e3c/67a3727c8abb3515ab42d712_Store%3DGoogle%20Play%2C%20Type%3DDark%2C%20Language%3DEnglish%402x.png",alt:"Google Play",width:90,height:28})})]})}),(0,n.jsxs)("div",{className:c().topRight,children:[(0,n.jsx)("nav",{className:c().headerNav,"aria-label":"Primary navigation",children:A.map(e=>(0,n.jsx)("button",{className:"".concat(c().navButtonLink," ").concat(m===e.key?c().activeLink:""),type:"button",onClick:e.onClick,children:e.label},e.key))}),t?(0,n.jsxs)("div",{className:c().authedActions,children:[(0,n.jsxs)("div",{className:c().notificationWrapper,children:[(0,n.jsxs)("button",{type:"button",className:c().bellButton,onClick:()=>{j||w(),H(!j)},"aria-label":"Notifications",children:[(0,n.jsx)(_,{}),k>0&&(0,n.jsx)("span",{className:c().badge,children:Math.min(k,99)})]}),j&&(0,n.jsxs)("div",{className:c().notificationPanel,children:[(0,n.jsxs)("div",{className:c().panelHeader,children:[(0,n.jsx)("p",{className:c().panelTitle,children:"Notifications"}),(0,n.jsxs)("div",{className:c().panelHeaderActions,children:[(0,n.jsx)("button",{type:"button",onClick:B,className:c().markAllButton,children:"Mark all read"}),(0,n.jsx)("button",{type:"button",onClick:()=>l.push("/notifications"),className:c().viewAllButton,children:"View all"})]})]}),(0,n.jsx)("div",{className:c().panelBody,children:b?(0,n.jsx)("p",{className:c().muted,children:"Loading..."}):0===N.length?(0,n.jsx)("p",{className:c().muted,children:"Youâ€™re all caught up."}):N.map(e=>(0,n.jsx)(f,{item:e},e.id))})]})]}),(0,n.jsx)("button",{className:c().nestButton,type:"button",onClick:()=>l.push("/nest"),"aria-label":"Message Nest",title:"Message Nest",children:(0,n.jsx)(h,{className:c().nestIcon})}),(0,n.jsx)("button",{className:c().profileIconButton,type:"button",onClick:()=>{l.push("/profile")},"aria-label":"Profile",title:"Profile",children:(0,n.jsx)(u,{className:c().profileIcon})})]}):(0,n.jsx)(o.default,{className:c().signInButton,href:"/registration",children:"Sign up"})]})]})}function _(){return(0,n.jsx)("svg",{viewBox:"0 0 24 24",width:22,height:22,"aria-hidden":"true",children:(0,n.jsx)("path",{fill:"currentColor",d:"M12 22a2.2 2.2 0 0 0 2.18-2H9.82A2.2 2.2 0 0 0 12 22Zm7.18-6.44-1.68-1.5V10a5.5 5.5 0 0 0-4.44-5.4V4a1.06 1.06 0 0 0-2.12 0v.6A5.5 5.5 0 0 0 6.5 10v4.06l-1.68 1.5A1 1 0 0 0 5 17.8h14a1 1 0 0 0 .68-1.74Z"})})}function f(e){let{item:a}=e,t=function(e){if(!e)return"";let a=new Date(e),t=Math.floor((Date.now()-a.getTime())/6e4);if(t<1)return"Just now";if(t<60)return"".concat(t,"m ago");let n=Math.floor(t/60);return n<24?"".concat(n,"h ago"):"".concat(Math.floor(n/24),"d ago")}(a.createdAt),i=a.actorUsername?a.actorUsername.startsWith("@")?a.actorUsername:"@".concat(a.actorUsername):"";return(0,n.jsx)("div",{className:"".concat(c().notificationItem," ").concat(a.isRead?c().read:""),children:(0,n.jsxs)("div",{className:c().notificationText,children:[(0,n.jsx)("p",{className:c().notificationTitle,children:a.title}),(0,n.jsxs)("p",{className:c().notificationMessage,children:[a.message," ",i&&(0,n.jsx)("span",{className:c().notificationActor,children:i})]}),(0,n.jsx)("span",{className:c().notificationTime,children:t})]})})}},9376:function(e,a,t){"use strict";var n=t(5475);t.o(n,"useParams")&&t.d(a,{useParams:function(){return n.useParams}}),t.o(n,"usePathname")&&t.d(a,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(a,{useRouter:function(){return n.useRouter}}),t.o(n,"useSearchParams")&&t.d(a,{useSearchParams:function(){return n.useSearchParams}})},6914:function(e){e.exports={topBar:"MainHeader_topBar__2Gv9B",topLeft:"MainHeader_topLeft__jEqkR",topRight:"MainHeader_topRight__5skVU",topCenter:"MainHeader_topCenter__8y2DR",logoLink:"MainHeader_logoLink__brAjr",logo:"MainHeader_logo__nhb5N",getApp:"MainHeader_getApp__QnGIn",getAppText:"MainHeader_getAppText__osfzX",storeIcon:"MainHeader_storeIcon__1Te5s",headerNav:"MainHeader_headerNav__Aybvx",navButtonLink:"MainHeader_navButtonLink__BkQ5V",activeLink:"MainHeader_activeLink__YR7BN",headerActions:"MainHeader_headerActions__lnV4D",authedActions:"MainHeader_authedActions__I3EqP",notificationWrapper:"MainHeader_notificationWrapper__pCInt",bellButton:"MainHeader_bellButton__WHQMB",nestButton:"MainHeader_nestButton__FManD",nestIcon:"MainHeader_nestIcon__5EllE",badge:"MainHeader_badge__ZuLVC",notificationPanel:"MainHeader_notificationPanel__nCegK",panelHeader:"MainHeader_panelHeader__3DD1M",panelTitle:"MainHeader_panelTitle__JI8kD",panelHeaderActions:"MainHeader_panelHeaderActions__g_bkX",markAllButton:"MainHeader_markAllButton__0EWsn",viewAllButton:"MainHeader_viewAllButton__G3lch",panelBody:"MainHeader_panelBody__MHvmD",notificationItem:"MainHeader_notificationItem__0jwsy",read:"MainHeader_read__fDUYg",notificationText:"MainHeader_notificationText__AodZg",notificationTitle:"MainHeader_notificationTitle__nDBMc",notificationMessage:"MainHeader_notificationMessage__3_Wln",notificationActor:"MainHeader_notificationActor__1Ecm4",notificationTime:"MainHeader_notificationTime__pH707",muted:"MainHeader_muted__fHeG9",profileButton:"MainHeader_profileButton__58Ird",profileIconButton:"MainHeader_profileIconButton__Qb4i9",signInButton:"MainHeader_signInButton__695wM",profileIcon:"MainHeader_profileIcon__w8HsK"}}}]);