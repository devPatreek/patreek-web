(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[215],{1215:function(e,t,a){"use strict";a.d(t,{default:function(){return _}});var n=a(7437),c=a(2265),r=a(9376),o=a(9116);let l="patreek_article_";function i(){try{let e=Date.now(),t=[];for(let a=0;a<localStorage.length;a++){let n=localStorage.key(a);if(null==n?void 0:n.startsWith(l))try{let a=localStorage.getItem(n);if(a){let c=JSON.parse(a);e-c.timestamp>6048e5&&t.push(n)}}catch(e){t.push(n)}}t.forEach(e=>localStorage.removeItem(e))}catch(e){console.error("Error clearing expired cache:",e)}}i();var s=a(7648),m=a(3145);function d(e){if(!e||0===e.trim().length)return e;let t=e.split(/\n\s*\n/),a=[];for(let e of t){let t=e.trim();if(!t)continue;if(t.length<=200){a.push(t);continue}let n=t.match(/[^.!?]+[.!?]+(?:\s+|$)/g)||[t],c="",r=0;for(let e of n){let t=e.trim().split(/\s+/).length;c&&(c.length+e.length>1e3||r+t>150)?(a.push(c.trim()),c=e.trim(),r=t):(c+=(c?" ":"")+e.trim(),r+=t)}c.trim()&&a.push(c.trim())}return a.join("\n\n")}var u=a(1402),h=a.n(u),f=a(7398),g=a.n(f);function p(e){var t;let{article:a}=e,[r,l]=(0,c.useState)(!1),[i,u]=(0,c.useState)([]),[f,p]=(0,c.useState)(!0);(0,c.useEffect)(()=>{let e=window.matchMedia("(prefers-color-scheme: dark)");l(e.matches);let t=e=>l(e.matches);return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[]),(0,c.useEffect)(()=>{(async function(){try{p(!0);let e=await (0,o.lk)(a.id);u(e)}catch(e){console.error("Failed to load comments:",e),u([])}finally{p(!1)}})()},[a.id]);let _=(t=a.createdAt,g()(t).isSame(g()(),"day"))?"Today in":g()(a.createdAt).format("MMM DD"),A=(0,c.useMemo)(()=>{var e;return(e=a.body)&&0!==e.trim().length?/<[a-z][\s\S]*>/i.test(e)?function(e){if(!e||0===e.trim().length)return e;let t=e.match(/<p[^>]*>[\s\S]*?<\/p>/gi);if(t&&t.length>1&&!t.some(e=>e.replace(/<[^>]*>/g,"").trim().length>1e3))return e;let a=e.replace(/<\/p>\s*<p[^>]*>/gi,"\n\n");a=(a=(a=a.replace(/<p[^>]*>/gi,"")).replace(/<\/p>/gi,"")).replace(/<\/?(div|section|article)[^>]*>/gi,"");let n={},c=0,r=d(a=a.replace(/<(\/?)([a-z]+)[^>]*>/gi,(e,t,a)=>{let r="__TAG_".concat(c,"__");return n[r]=e,c++,r}));return Object.keys(n).forEach(e=>{r=r.replace(e,n[e])}),r.split(/\n\s*\n/).filter(e=>e.trim()).map(e=>"<p>".concat(e.trim(),"</p>")).join("\n")}(e):d(e):e},[a.body]);return(0,n.jsxs)("div",{className:"".concat(h().container," ").concat(r?h().dark:""),children:[(0,n.jsx)("header",{className:h().header,children:(0,n.jsxs)("div",{className:h().headerInner,children:[(0,n.jsx)(s.default,{href:"/",className:h().logoLink,children:(0,n.jsx)(m.default,{src:"https://cdn.prod.website-files.com/675ca775325477a121669e3c/675caa3a2f73ad268a86b51a_Patreek%20logo_slogan.png",alt:"Patreek",width:50,height:50,className:h().logo})}),(0,n.jsxs)("div",{className:h().headerCenter,children:[(0,n.jsx)("h1",{className:h().categoryName,children:a.categoryName}),(0,n.jsx)("p",{className:h().date,children:_})]})]})}),(0,n.jsx)("main",{className:h().main,children:(0,n.jsxs)("article",{className:h().article,children:[a.imageUrl&&(0,n.jsx)("div",{className:h().imageWrapper,children:(0,n.jsx)("img",{src:a.imageUrl,alt:a.title,className:h().image})}),(0,n.jsx)("h1",{className:h().title,children:a.title}),a.excerpt&&(0,n.jsx)("p",{className:h().description,children:a.excerpt}),(0,n.jsx)("div",{className:h().content,dangerouslySetInnerHTML:{__html:A}}),(0,n.jsxs)("div",{className:h().commentsSection,children:[(0,n.jsx)("h2",{className:h().commentsTitle,children:"Comments"}),f?(0,n.jsx)("p",{className:h().commentsLoading,children:"Loading comments..."}):0===i.length?(0,n.jsx)("p",{className:h().noComments,children:"No comments yet."}):(0,n.jsx)("div",{className:h().commentsList,children:i.map((e,t)=>(0,n.jsxs)("div",{className:h().commentItem,children:[(0,n.jsxs)("div",{className:h().commentHeader,children:[e.photoUrl&&(0,n.jsx)("img",{src:e.photoUrl,alt:e.author,className:h().commentAvatar}),(0,n.jsxs)("div",{className:h().commentAuthorInfo,children:[(0,n.jsx)("span",{className:h().commentAuthor,children:e.author}),(0,n.jsx)("span",{className:h().commentDate,children:g()(e.createdAt).format("MMM DD, YYYY")})]})]}),(0,n.jsx)("p",{className:h().commentBody,children:e.body})]},t))})]}),(0,n.jsx)("div",{className:h().unlockBanner,children:(0,n.jsxs)("div",{className:h().unlockBannerContent,children:[(0,n.jsx)("p",{className:h().unlockText,children:"UNLOCK YOUR NEWS FEED"}),(0,n.jsxs)("p",{className:h().unlockDescription,children:["Register to get the latest updates from the topics"," ",(0,n.jsx)("span",{className:h().unlockUnderline,children:"you"})," care about"]}),(0,n.jsxs)("div",{className:h().storeButtons,children:[(0,n.jsx)("a",{href:"https://apps.apple.com/us/app/patreek/id6547858283",target:"_blank",rel:"noopener noreferrer",className:h().storeLink,children:(0,n.jsx)(m.default,{src:"https://cdn.prod.website-files.com/675ca775325477a121669e3c/67a3729b558347b9bf210a5a_Store%3DApp%20Store%2C%20Type%3DDark%2C%20Language%3DEnglish%402x.png",alt:"Download on App Store",width:200,height:60,className:h().storeImage})}),(0,n.jsx)("a",{href:"#",className:h().storeLink,children:(0,n.jsx)(m.default,{src:"https://cdn.prod.website-files.com/675ca775325477a121669e3c/67a3727c8abb3515ab42d712_Store%3DGoogle%20Play%2C%20Type%3DDark%2C%20Language%3DEnglish%402x.png",alt:"Get it on Google Play",width:200,height:60,className:h().storeImage})})]})]})})]})})]})}function _(){let e=(0,r.usePathname)(),[t,a]=(0,c.useState)(null),[s,m]=(0,c.useState)(!0),[d,u]=(0,c.useState)(null);return((0,c.useEffect)(()=>{(async function(){let t=null;{let e=window.location.pathname.match(/\/article\/(\d+)/);e&&(t=parseInt(e[1],10),console.log("[ArticlePage] Extracted article ID from window.location: ".concat(t)))}if(!t&&e){let a=e.match(/\/article\/(\d+)/);a&&(t=parseInt(a[1],10),console.log("[ArticlePage] Extracted article ID from pathname: ".concat(t)))}if(!t||isNaN(t)||t<=0){console.error("[ArticlePage] Invalid article ID: ".concat(t,", pathname: ").concat(e,", window.location.pathname: ").concat(window.location.pathname)),u("Invalid article ID"),m(!1);return}try{m(!0),console.log("[ArticlePage] Loading article ".concat(t,"..."));let e=function(e){try{let t="".concat(l).concat(e),a=localStorage.getItem(t);if(!a)return null;let n=JSON.parse(a);if(Date.now()-n.timestamp>6048e5)return localStorage.removeItem(t),null;return n.data}catch(e){return console.error("Error reading from cache:",e),null}}(t);if(e){console.log("[ArticlePage] Using cached article ".concat(t)),a(e),u(null),m(!1);return}console.log("[ArticlePage] Fetching article ".concat(t," from API"));let n=await (0,o.ST)(t);if(!n){console.log("[ArticlePage] Article ".concat(t," not found or not public (returned null), redirecting to home")),u("Article not found or not available"),setTimeout(()=>{window.location.href="https://links.patreek.com/"},2e3);return}(function(e,t){let a="".concat(l).concat(e),n={data:t,timestamp:Date.now()};try{localStorage.setItem(a,JSON.stringify(n))}catch(e){if(console.error("Error writing to cache:",e),e instanceof DOMException&&"QuotaExceededError"===e.name){i();try{localStorage.setItem(a,JSON.stringify(n))}catch(e){console.error("Failed to cache after cleanup:",e)}}}})(t,n),a(n),u(null),console.log("[ArticlePage] Successfully loaded article ".concat(t,": ").concat(n.title))}catch(e){console.error("[ArticlePage] Failed to load article:",e),u("Failed to load article. Please try again later.")}finally{m(!1)}})()},[e]),s)?(0,n.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",color:"#333"},children:(0,n.jsx)("p",{children:"Loading article..."})}):d||!t?(0,n.jsxs)("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#f5f5f5",color:"#333",padding:"20px"},children:[(0,n.jsx)("p",{children:d||"Article not found"}),(0,n.jsx)("a",{href:"/",style:{marginTop:"16px",color:"#667eea",textDecoration:"underline"},children:"â† Back to Home"})]}):(0,n.jsx)(p,{article:t})}},9116:function(e,t,a){"use strict";a.d(t,{Dk:function(){return c},ST:function(){return r},lk:function(){return o}});let n="https://patreekbackend-env.eba-ifvfvi7q.us-east-1.elasticbeanstalk.com";async function c(){try{let e=new AbortController,t=setTimeout(()=>e.abort(),1e4),a=await fetch("".concat(n,"/api/v1/feeds/public"),{method:"GET",cache:"default",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:e.signal});if(clearTimeout(t),!a.ok)return console.warn("[API] Failed to fetch public feeds: ".concat(a.status)),[];return((await a.json()).content||[]).slice(0,30)}catch(e){return e instanceof Error?"AbortError"===e.name||e.message.includes("timeout")||e.message.includes("TIMED_OUT")?console.warn("[API] Connection timeout while fetching public feeds - backend may be unavailable"):e.message.includes("Failed to fetch")||e.message.includes("ERR_CONNECTION")?console.warn("[API] Connection error while fetching public feeds - backend may be unavailable"):console.warn("[API] Error fetching public feeds:",e.message):console.warn("[API] Unknown error fetching public feeds:",e),[]}}async function r(e){try{let t=new AbortController,a=setTimeout(()=>t.abort(),1e4),c="".concat(n,"/api/v1/feeds/").concat(e);console.log("[API] Fetching article ".concat(e," from: ").concat(c));let r=await fetch(c,{method:"GET",cache:"default",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:t.signal});if(clearTimeout(a),!r.ok){if(404===r.status||403===r.status)return console.warn("[API] Article ".concat(e," not found or not available (").concat(r.status,")")),null;return console.warn("[API] Failed to fetch feed ".concat(e,": ").concat(r.status)),null}let o=await r.json();return console.log("[API] Successfully fetched article ".concat(e,":"),o.title),o}catch(t){return t instanceof Error?"AbortError"===t.name||t.message.includes("timeout")||t.message.includes("TIMED_OUT")?console.warn("[API] Connection timeout while fetching article ".concat(e," - backend may be unavailable")):t.message.includes("Failed to fetch")||t.message.includes("ERR_CONNECTION")?console.warn("[API] Connection error while fetching article ".concat(e," - backend may be unavailable")):console.warn("[API] Error fetching feed ".concat(e,":"),t.message):console.warn("[API] Unknown error fetching feed ".concat(e,":"),t),null}}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;try{let c=new AbortController,r=setTimeout(()=>c.abort(),1e4),o=await fetch("".concat(n,"/api/v1/feeds/").concat(e,"/comments?page=").concat(t,"&size=").concat(a),{method:"GET",cache:"default",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:c.signal});if(clearTimeout(r),!o.ok)return console.warn("[API] Failed to fetch comments for feed ".concat(e,": ").concat(o.status)),[];return(await o.json()).content||[]}catch(t){return t instanceof Error?"AbortError"===t.name||t.message.includes("timeout")?console.warn("[API] Connection timeout while fetching comments for feed ".concat(e)):console.warn("[API] Error fetching comments for feed ".concat(e,":"),t.message):console.warn("[API] Unknown error fetching comments for feed ".concat(e,":"),t),[]}}},9376:function(e,t,a){"use strict";var n=a(5475);a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}})},1402:function(e){e.exports={container:"ArticleReader_container__jO2L5",dark:"ArticleReader_dark__PbS6A",header:"ArticleReader_header__dbPzK",headerInner:"ArticleReader_headerInner__yrlm4",logoLink:"ArticleReader_logoLink__Kc5xR",logo:"ArticleReader_logo__Ffm7W",headerCenter:"ArticleReader_headerCenter__ju69k",categoryName:"ArticleReader_categoryName__DrJk6",date:"ArticleReader_date__7kari",main:"ArticleReader_main__vwq7A",article:"ArticleReader_article__XHm3G",imageWrapper:"ArticleReader_imageWrapper__NI6E9",image:"ArticleReader_image__pYNG4",title:"ArticleReader_title__0ba_F",description:"ArticleReader_description__FGiUV",content:"ArticleReader_content__KVC5g",unlockBanner:"ArticleReader_unlockBanner__4dPP0",unlockBannerContent:"ArticleReader_unlockBannerContent__xQm1Q",unlockText:"ArticleReader_unlockText__XI_xN",unlockDescription:"ArticleReader_unlockDescription__D8kgb",unlockUnderline:"ArticleReader_unlockUnderline__MRWY0",storeButtons:"ArticleReader_storeButtons__KTAzN",storeLink:"ArticleReader_storeLink__8tyrD",storeImage:"ArticleReader_storeImage__DCJpi",commentsSection:"ArticleReader_commentsSection__rqZOR",commentsTitle:"ArticleReader_commentsTitle__xw6PS",commentsLoading:"ArticleReader_commentsLoading__nu_pR",noComments:"ArticleReader_noComments__eVpLR",commentsList:"ArticleReader_commentsList__I_eEj",commentItem:"ArticleReader_commentItem__h_m06",commentHeader:"ArticleReader_commentHeader__bKesh",commentAvatar:"ArticleReader_commentAvatar___Zlwi",commentAuthorInfo:"ArticleReader_commentAuthorInfo__GWLyj",commentAuthor:"ArticleReader_commentAuthor__CQ3yY",commentDate:"ArticleReader_commentDate__eV3mx",commentBody:"ArticleReader_commentBody__SaDKq"}}}]);