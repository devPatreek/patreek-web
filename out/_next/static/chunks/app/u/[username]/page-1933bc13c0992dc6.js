(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8977],{9092:function(e,a,t){Promise.resolve().then(t.bind(t,5411))},5411:function(e,a,t){"use strict";t.d(a,{default:function(){return u}});var l=t(7437),s=t(2265),i=t(9376),r=t(7648),n=t(3595),c=t(8349),o=t(7029),d=t(9799),_=t.n(d);function u(e){let{params:a}=e,t=(0,i.useRouter)(),d=(0,i.useParams)(),u=(null==a?void 0:a.username)||(null==d?void 0:d.username)||"",[p,h]=(0,s.useState)(null),[m,f]=(0,s.useState)(null),[g,v]=(0,s.useState)(!1),[b,x]=(0,s.useState)(!1),[N,j]=(0,s.useState)("loading"),[k,w]=(0,s.useState)([]),[D,y]=(0,s.useState)(null),[C,S]=(0,s.useState)(!1),[B,R]=(0,s.useState)(!1),[P,T]=(0,s.useState)([]),[L,F]=(0,s.useState)(!1),[A,E]=(0,s.useState)(!1),U=(0,s.useMemo)(()=>[{label:"Home",href:"/"},{label:"Notifications",href:"/notifications"},{label:"Nest",href:"/nest"},{label:"Bookmarks",href:"/bookmarks"},{label:"Communities",href:"/communities"},{label:"Premium",href:"/premium"},{label:"Profile",href:(null==m?void 0:m.username)?"/u/".concat(m.username):"/profile"},{label:"Support",href:"/support"}],[null==m?void 0:m.username]);(0,s.useEffect)(()=>{let e=!0,a=async()=>{j("loading");try{let a=await (0,o.Zm)(u);if(!e)return;if(!a){j("error");return}h(a),j("ready")}catch(a){console.warn("[Profile] failed to load profile",a),e&&j("error")}};return u&&a(),()=>{e=!1}},[u]),(0,s.useEffect)(()=>{let e=!0;return(async()=>{try{var a,t,l;let s=await (0,o.checkSessionStatus)();if(!e)return;let i=null!==(t=null!==(a=s.isAuthenticated)&&void 0!==a?a:s.authenticated)&&void 0!==t&&t;if(v(i),i){let a=await (0,o.getUserProfile)();if(!e)return;f(a),x((null==a?void 0:null===(l=a.username)||void 0===l?void 0:l.toLowerCase())===u.toLowerCase())}else x(!1)}catch(e){console.warn("[Profile] session check failed",e)}})(),()=>{e=!1}},[u]);let H=(0,s.useCallback)(async()=>{S(!0);try{let e=await (0,o.U1)();w(e||[]),e&&e.length>0&&y(e[0].id)}catch(e){console.warn("[Profile] load categories failed",e)}finally{S(!1)}},[]),O=(0,s.useCallback)(async e=>{if(e){R(!0);try{let a=await (0,o.HE)(void 0,e);T(a||[])}catch(e){console.warn("[Profile] load feeds failed",e)}finally{R(!1)}}},[]);(0,s.useEffect)(()=>{g&&H()},[g,H]),(0,s.useEffect)(()=>{D&&O(D)},[D,O]);let z=async e=>{var a;if(!b)return;let t=null===(a=e.target.files)||void 0===a?void 0:a[0];if(t)try{F(!0);let e=await (0,o.gg)(t);e&&(h(a=>a?{...a,avatarUrl:e}:a),f(a=>a?{...a,avatarUrl:e}:a))}catch(e){console.error("[Profile] avatar upload failed",e)}finally{F(!1)}},M=(0,s.useMemo)(()=>k.find(e=>e.id===D)||null,[k,D]),V=(0,s.useMemo)(()=>p?[p.location&&{icon:"\uD83D\uDCCD",text:p.location},p.website&&{icon:"\uD83D\uDD17",text:p.website,href:p.website.startsWith("http")?p.website:"https://".concat(p.website)},p.createdAt&&{icon:"\uD83D\uDCC5",text:"Joined ".concat(new Date(p.createdAt).toLocaleDateString())},p.rank&&{icon:"\uD83C\uDF96️",text:p.rank.name||(p.rank.level?"Level ".concat(p.rank.level):"Ranked")}].filter(Boolean):null,[p]),Z=null==p?void 0:p.avatarUrl;return(0,l.jsxs)("div",{className:_().page,children:[(0,l.jsx)(n.Z,{}),(0,l.jsxs)("div",{className:_().body,children:[(0,l.jsxs)("aside",{className:_().sidebar,children:[(0,l.jsx)("button",{className:_().navToggle,onClick:()=>E(!A),children:"☰"}),(0,l.jsx)("nav",{className:"".concat(_().navLinks," ").concat(A?_().navOpen:""),children:U.map(e=>(0,l.jsx)(r.default,{href:e.href,className:_().navItem,children:e.label},e.href))}),b&&(0,l.jsx)("button",{className:_().editProfileBtn,onClick:()=>t.push("/profile"),children:"Edit Profile"})]}),(0,l.jsxs)("main",{className:_().content,children:[(0,l.jsx)("div",{className:_().banner}),(0,l.jsxs)("div",{className:_().profileHeader,children:[(0,l.jsxs)("div",{className:_().avatarWrapper,children:[Z?(0,l.jsx)("img",{src:Z,alt:(null==p?void 0:p.username)||"avatar"}):(0,l.jsx)("div",{className:_().avatarFallback,children:"\uD83D\uDE0A"}),b&&(0,l.jsxs)("label",{className:_().avatarUpload,children:[(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:z,disabled:L}),L?"Uploading...":"Change"]})]}),(0,l.jsxs)("div",{className:_().profileText,children:[(0,l.jsx)("h1",{children:(null==p?void 0:p.fullName)||(null==p?void 0:p.username)||"User"}),(0,l.jsxs)("p",{className:_().handle,children:["@",null==p?void 0:p.username]}),(null==p?void 0:p.bio)&&(0,l.jsx)("p",{className:_().bio,children:p.bio}),(0,l.jsx)("div",{className:_().metaRow,children:null==V?void 0:V.map((e,a)=>e.href?(0,l.jsxs)("a",{href:e.href,target:"_blank",rel:"noreferrer",className:_().metaItem,children:[(0,l.jsx)("span",{children:e.icon})," ",e.text]},a):(0,l.jsxs)("span",{className:_().metaItem,children:[(0,l.jsx)("span",{children:e.icon})," ",e.text]},a))})]})]}),(0,l.jsxs)("div",{className:_().chipsRow,children:[C&&(0,l.jsx)("span",{className:_().muted,children:"Loading categories…"}),!C&&k.map(e=>(0,l.jsx)("button",{className:"".concat(_().chip," ").concat(D===e.id?_().chipActive:""),onClick:()=>y(e.id),children:e.name},e.id))]}),(0,l.jsxs)("div",{className:_().feedList,children:[B&&(0,l.jsx)("div",{className:_().muted,children:"Loading feeds…"}),!B&&0===P.length&&(0,l.jsxs)("div",{className:_().muted,children:["No posts yet in ",(null==M?void 0:M.name)||"this category","."]}),!B&&P.map(e=>(0,l.jsxs)("div",{className:_().feedCard,onClick:()=>t.push("/pat/".concat(e.id)),children:[(0,l.jsx)("div",{className:_().feedThumb,children:e.imageUrl?(0,l.jsx)("img",{src:e.imageUrl,alt:e.title}):(0,l.jsx)("div",{className:_().thumbFallback,children:"\uD83D\uDCD6"})}),(0,l.jsxs)("div",{className:_().feedBody,children:[(0,l.jsxs)("div",{className:_().feedMeta,children:[(0,l.jsx)("span",{className:_().feedSource,children:e.source||"Patreek"}),(0,l.jsx)("span",{className:_().feedDate,children:e.publishedAt?new Date(e.publishedAt).toLocaleDateString():""})]}),(0,l.jsx)("h3",{className:_().feedTitle,children:e.title}),e.description&&(0,l.jsx)("p",{className:_().feedDesc,children:e.description})]})]},e.id))]})]}),(0,l.jsx)("aside",{className:_().widgets,children:(0,l.jsxs)("div",{className:_().widgetCard,children:[(0,l.jsx)("h4",{children:"Widgets"}),(0,l.jsx)("p",{className:_().muted,children:"Personalized slots coming soon."})]})})]}),(0,l.jsx)(c.Z,{})]})}},9799:function(e){e.exports={page:"page_page__bc9x8",shell:"page_shell__EiTdp",leftRail:"page_leftRail__xDtNF",leftRailOpen:"page_leftRailOpen__6SkfD",leftHeader:"page_leftHeader__c8448",brand:"page_brand__0teP_",closeNav:"page_closeNav__zYRKx",navList:"page_navList__igeFN",navItem:"page_navItem__DXqhz",leftFooter:"page_leftFooter__Ssnog",primaryButton:"page_primaryButton__SR7sG",ghostButton:"page_ghostButton__zBR6R",center:"page_center__1OY8U",mobileNavBar:"page_mobileNavBar__RjZmm",iconButton:"page_iconButton__1PE3z",mobileTitle:"page_mobileTitle__JTiue",profileCard:"page_profileCard___6uZc",cover:"page_cover__l7NHn",coverGradient:"page_coverGradient__qx5hb",profileBody:"page_profileBody__7IaSt",avatarRow:"page_avatarRow__aZogB",avatarWrap:"page_avatarWrap__Ueeby",avatar:"page_avatar__yvOeV",avatarFallback:"page_avatarFallback__88VIk",uploadBadge:"page_uploadBadge__3zJhz",actions:"page_actions__ytDTK",rankPill:"page_rankPill__yguCh",headerText:"page_headerText__qNTlQ",name:"page_name__mSM7W",username:"page_username__0rLvi",bio:"page_bio__ABK9d",metaRow:"page_metaRow__Vv7fO",subtle:"page_subtle__8CiCl",stats:"page_stats__ByTxm",stat:"page_stat__FHatH",statValue:"page_statValue__zFXk1",statLabel:"page_statLabel__7eh41",tabsCard:"page_tabsCard__lQ1Ar",chipsRow:"page_chipsRow__3CbVV",chipsScroller:"page_chipsScroller__UYMRh",chipBtn:"page_chipBtn__75F2Q",chipActive:"page_chipActive__qOoDJ",feedList:"page_feedList__2hX58",feedCard:"page_feedCard__V8fiZ",feedThumb:"page_feedThumb__lyhTm",thumbFallback:"page_thumbFallback__k3H_D",feedBody:"page_feedBody__4P8Ak",feedMeta:"page_feedMeta__v4AiZ",chip:"page_chip__e4lNS",cardTitle:"page_cardTitle__DwiyR",rightRail:"page_rightRail__wOplE",widgetCard:"page_widgetCard__vKQ8p",widgetList:"page_widgetList__kJTDm",placeholder:"page_placeholder__ypFm0",loadingState:"page_loadingState__P6sRP",linkButton:"page_linkButton__8Hucz"}}},function(e){e.O(0,[563,9494,2972,5726,1908,7611,2971,2117,1744],function(){return e(e.s=9092)}),_N_E=e.O()}]);